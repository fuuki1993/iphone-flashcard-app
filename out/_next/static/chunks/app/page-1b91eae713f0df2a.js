(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4990:function(e,s,t){Promise.resolve().then(t.bind(t,1676))},1676:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return se}});var a=t(7437),l=t(2265);let i="sets",r="studyHistory",n=()=>new Promise((e,s)=>{let t=indexedDB.open("FlashcardApp",3);t.onerror=()=>s("Error opening database"),t.onsuccess=s=>e(s.target.result),t.onupgradeneeded=e=>{let s=e.target.result;s.objectStoreNames.contains(i)||s.createObjectStore(i,{keyPath:"id",autoIncrement:!0}).createIndex("type","type",{unique:!1}),s.objectStoreNames.contains(r)||s.createObjectStore(r,{keyPath:"id",autoIncrement:!0}).createIndex("date","date",{unique:!1})}}),c=async(e,s,t,a,l,i)=>{let c=await n();return new Promise((n,o)=>{let d=c.transaction([r],"readwrite").objectStore(r),m={setId:e,setTitle:s,setType:t,score:a,date:l.toISOString(),studyDuration:i},x=d.add(m);x.onerror=()=>o("Error saving study history"),x.onsuccess=()=>n(x.result)})},o=async()=>{let e=await n();return new Promise((s,t)=>{let a=e.transaction([r],"readonly").objectStore(r).getAll();a.onerror=()=>t("Error getting study history"),a.onsuccess=()=>{s(a.result.sort((e,s)=>new Date(s.date)-new Date(e.date)))}})},d=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readwrite").objectStore(i).add(e);l.onerror=()=>a("Error saving set"),l.onsuccess=()=>t(l.result)})},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=await n();return new Promise((t,a)=>{let l;let r=s.transaction([i],"readonly").objectStore(i);(l=e?r.index("type").getAll(e):r.getAll()).onerror=()=>a("Error getting sets"),l.onsuccess=()=>t(l.result)})},x=async()=>{let e=await n();return new Promise((s,t)=>{let a=e.transaction(i,"readonly").objectStore(i).getAll();a.onerror=()=>t("Error getting all sets"),a.onsuccess=()=>s(a.result)})},h=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readonly").objectStore(i).get(e);l.onerror=()=>a("Error getting set"),l.onsuccess=()=>t(l.result)})},u=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readwrite").objectStore(i).put(e);l.onerror=()=>a("Error updating set"),l.onsuccess=()=>t(l.result)})},f=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readwrite").objectStore(i).delete(e);l.onerror=()=>a("Error deleting set"),l.onsuccess=()=>t(l.result)})};var j=t(4839),g=t(6164);function p(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,g.m6)((0,j.W)(s))}let N=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:p("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});N.displayName="Card";let v=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:p("flex flex-col space-y-1.5 p-6",t),...l})});v.displayName="CardHeader";let b=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h3",{ref:s,className:p("text-2xl font-semibold leading-none tracking-tight",t),...l})});b.displayName="CardTitle",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("p",{ref:s,className:p("text-sm text-muted-foreground",t),...l})}).displayName="CardDescription";let y=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:p("p-6 pt-0",t),...l})});y.displayName="CardContent";let w=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:p("flex items-center p-6 pt-0",t),...l})});w.displayName="CardFooter";var C=t(1538),S=t(2218);let k=(0,S.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Z=l.forwardRef((e,s)=>{let{className:t,variant:l,size:i,asChild:r=!1,...n}=e,c=r?C.g7:"button";return(0,a.jsx)(c,{className:p(k({variant:l,size:i,className:t})),ref:s,...n})});Z.displayName="Button";var z=t(6506);let E=l.forwardRef((e,s)=>{let{className:t,value:l,indicatorClassName:i,...r}=e;return(0,a.jsx)(z.fC,{ref:s,className:p("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:(0,a.jsx)(z.z$,{className:p("h-full w-full flex-1 bg-primary transition-all",i),style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});E.displayName=z.fC.displayName;var q=t(9385);let R=q.fC,D=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.aV,{ref:s,className:p("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});D.displayName=q.aV.displayName;let I=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.xz,{ref:s,className:p("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});I.displayName=q.xz.displayName;let T=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.VY,{ref:s,className:p("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});T.displayName=q.VY.displayName;var F=t(8948),A=t(4436),M=t(7746),_=t(4241),O=t(4258),B=t(5016),L=t(7427),V=t(6273),P=t(6540),U=t(933),Q=t(3304),H=t(4697);let Y=Q.fC;Q.xz;let G=Q.h_;Q.x8;let W=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.aV,{ref:s,className:p("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});W.displayName=Q.aV.displayName;let $=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(G,{children:[(0,a.jsx)(W,{}),(0,a.jsxs)(Q.VY,{ref:s,className:p("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[l,(0,a.jsxs)(Q.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(H.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});$.displayName=Q.VY.displayName;let J=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:p("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};J.displayName="DialogHeader";let X=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:p("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};X.displayName="DialogFooter";let K=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.Dx,{ref:s,className:p("text-lg font-semibold leading-none tracking-tight",t),...l})});K.displayName=Q.Dx.displayName;let ee=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.dk,{ref:s,className:p("text-sm text-muted-foreground",t),...l})});ee.displayName=Q.dk.displayName;let es=l.forwardRef((e,s)=>{let{className:t,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:p("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});es.displayName="Input";var et=t(8364);let ea=(0,S.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),el=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(et.f,{ref:s,className:p(ea(),t),...l})});el.displayName=et.f.displayName;var ei=t(883),er=e=>{let{isOpen:s,onClose:t,onSave:i,onDelete:r,editingEvent:n}=e,[c,o]=(0,l.useState)(""),[d,m]=(0,l.useState)(""),[x,h]=(0,l.useState)("");return(0,l.useEffect)(()=>{if(n){o(n.title);let e=new Date(n.date);m(e.toISOString().split("T")[0]),h(e.toTimeString().slice(0,5))}else o(""),m(""),h("")},[n]),(0,a.jsx)(Y,{open:s,onOpenChange:t,children:(0,a.jsxs)($,{children:[(0,a.jsxs)(J,{children:[(0,a.jsx)(K,{children:n?"予定を編集":"予定を追加"}),(0,a.jsx)(ee,{children:n?"既存の予定を編集します。":"新しい予定を追加します。"})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(el,{htmlFor:"title",className:"text-right",children:"タイトル"}),(0,a.jsx)(es,{id:"title",value:c,onChange:e=>o(e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(el,{htmlFor:"date",className:"text-right",children:"日付"}),(0,a.jsx)(es,{id:"date",type:"date",value:d,onChange:e=>m(e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(el,{htmlFor:"time",className:"text-right",children:"時間"}),(0,a.jsx)(es,{id:"time",type:"time",value:x,onChange:e=>h(e.target.value),className:"col-span-3"})]})]}),(0,a.jsxs)(X,{children:[n&&(0,a.jsxs)(Z,{variant:"destructive",onClick:()=>{n&&(r(n.id),t())},children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"}),"削除"]}),(0,a.jsx)(Z,{onClick:()=>{let e=new Date("".concat(d,"T").concat(x));i({id:null==n?void 0:n.id,title:c,date:e}),t()},children:"保存"})]})]})})},en=e=>{let{onCreateSet:s,onStartLearning:t,onShowStatistics:i,overallProgress:r,setOverallProgress:n,streak:c,setStreak:d,studyHistory:m,setStudyHistory:h,dailyGoal:u,setDailyGoal:f,todayStudyTime:j,setTodayStudyTime:g}=e,[p,w]=(0,l.useState)(!1),[C,S]=(0,l.useState)([]),[k,z]=(0,l.useState)(!1),[q,Q]=(0,l.useState)(null),H=(0,l.useCallback)(async()=>{try{let e=await o(),s=await x(),t=0,a=0;s.forEach(e=>{"flashcard"===e.type||"qa"===e.type?t+=e.cards?e.cards.length:0:("multiple-choice"===e.type||"classification"===e.type)&&(t+=e.questions?e.questions.length:0)}),e.forEach(e=>{let s=Math.round(e.score/100*(e.totalQuestions||1));a+=s}),a=Math.min(a,t);let l=t>0?a/t*100:0;n(Math.round(l));let i=new Date().toISOString().split("T")[0],r=e.filter(e=>e.date.startsWith(i)).reduce((e,s)=>e+(s.studyDuration||0),0),c=Math.round(r/60);g(c),w(c>=u);let d=Array.from(new Set(e.map(e=>e.setId))).slice(0,3).map(s=>e.find(e=>e.setId===s));h(d)}catch(e){console.error("Error loading study data:",e)}},[u,n,g,h]);(0,l.useEffect)(()=>{H()},[H]),(0,l.useEffect)(()=>{w(j>=u)},[j,u]);let Y=(0,l.useCallback)(()=>{p?d(e=>e+1):d(0)},[p]);(0,l.useEffect)(()=>{Y()},[p,Y]);let G=e=>{switch(e){case"flashcard":default:return(0,a.jsx)(F.Z,{className:"mr-3 text-blue-500",size:24});case"qa":return(0,a.jsx)(A.Z,{className:"mr-3 text-green-500",size:24});case"multiple-choice":return(0,a.jsx)(M.Z,{className:"mr-3 text-purple-500",size:24});case"classification":return(0,a.jsx)(_.Z,{className:"mr-3 text-red-500",size:24})}},W=e=>{let s=new Date(e),t=Math.abs(new Date-s),a=Math.floor(t/6e4),l=Math.floor(t/36e5),i=Math.floor(t/864e5);return a<60?"".concat(a,"分前"):l<24?"".concat(l,"時間前"):0===i?"今日":1===i?"昨日":"".concat(i,"日前")},$=e=>new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=e=>{Q(e),z(!0)},X=e=>{let s=new Date,t=new Date(e.date).getTime()-s.getTime();t>0&&setTimeout(()=>{"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:"予定の時間です！"})},t)};return(0,l.useEffect)(()=>{"Notification"in window&&Notification.requestPermission()},[]),(0,a.jsxs)("div",{className:"p-3 w-full max-w-[390px] mx-auto bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-800",children:"暗記アプリ"}),(0,a.jsx)(Z,{variant:"ghost",size:"sm",onClick:()=>console.log("設定を開く"),children:(0,a.jsx)(O.Z,{className:"text-gray-600 h-5 w-5"})})]}),(0,a.jsx)(N,{className:"mb-3 bg-gray-800 text-white",children:(0,a.jsxs)(y,{className:"py-2 px-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(B.Z,{className:"mr-1 text-gray-300",size:16}),(0,a.jsxs)("span",{className:"font-bold text-xs",children:["継続: ",c,"日"]})]}),(0,a.jsxs)(Z,{variant:"outline",size:"xs",onClick:i,className:"text-xs px-2 py-1 text-gray-800 bg-gray-200 hover:bg-gray-300",children:[(0,a.jsx)(L.Z,{className:"mr-1 h-3 w-3"}),"詳細"]})]}),(0,a.jsx)("p",{className:"mb-1 text-xs",children:"全体の進捗"}),(0,a.jsx)(E,{value:r,className:"w-full h-2 bg-gray-600",indicatorClassName:"bg-white"}),(0,a.jsxs)("p",{className:"text-center mt-1 text-xs",children:[r.toFixed(1),"%"]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,a.jsxs)(Z,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:s,children:[(0,a.jsx)(V.Z,{className:"mr-1 h-3 w-3"}),"作成/編集"]}),(0,a.jsxs)(Z,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:t,children:[(0,a.jsx)(P.Z,{className:"mr-1 h-3 w-3"}),"学習開始"]})]}),(0,a.jsxs)(R,{defaultValue:"recent",className:"mb-3",children:[(0,a.jsxs)(D,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(I,{value:"recent",className:"text-xs",children:"最近の学習"}),(0,a.jsx)(I,{value:"scheduled",className:"text-xs",children:"予定"})]}),(0,a.jsx)(T,{value:"recent",children:(0,a.jsx)(N,{children:(0,a.jsx)(y,{className:"py-2 px-3",children:(0,a.jsx)("ul",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("li",{className:"flex items-center",children:[G(e.setType),(0,a.jsxs)("div",{className:"flex-1 ml-2",children:[(0,a.jsx)("span",{className:"font-medium text-xs",children:e.setTitle}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:W(e.date)})]}),(0,a.jsxs)("span",{className:"text-[10px] font-medium",children:[Math.round(e.score),"%"]})]},e.id))})})})}),(0,a.jsx)(T,{value:"scheduled",children:(0,a.jsx)(N,{children:(0,a.jsxs)(y,{className:"py-2 px-3",children:[(0,a.jsx)("ul",{className:"space-y-2",children:C.map(e=>(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(_.Z,{className:"mr-3 text-blue-500",size:24}),(0,a.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>J(e),children:[(0,a.jsx)("span",{className:"font-medium text-xs",children:e.title}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:$(e.date)})]})]},e.id))}),(0,a.jsxs)(Z,{className:"w-full mt-4",onClick:()=>{Q(null),z(!0)},children:[(0,a.jsx)(V.Z,{className:"mr-2 h-4 w-4"}),"予定を追加"]})]})})})]}),(0,a.jsxs)(N,{children:[(0,a.jsx)(v,{className:"py-2 px-3",children:(0,a.jsxs)(b,{className:"flex items-center text-sm",children:[(0,a.jsx)(U.Z,{className:"mr-2 text-gray-600",size:16}),"今日の目標"]})}),(0,a.jsxs)(y,{className:"py-2 px-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-xs",children:[j,"分 / ",u,"分"]}),(0,a.jsx)(E,{value:j/u*100,className:"w-1/2 h-2"})]}),p&&(0,a.jsx)("p",{className:"text-gray-700 font-bold text-xs",children:"目標達成！"})]})]}),(0,a.jsx)(er,{isOpen:k,onClose:()=>z(!1),onSave:e=>{e.id?S(C.map(s=>s.id===e.id?e:s)):S([...C,{...e,id:Date.now()}]),X(e)},onDelete:e=>{S(C.filter(s=>s.id!==e))},editingEvent:q})]})},ec=t(5574),eo=t(374),ed=t(5931),em=t(1266),ex=t(2513),eh=t(6649),eu=e=>{let{onBack:s,onSelectType:t,onEditType:l}=e,i=[{id:"flashcard",title:"フラッシュカード",icon:P.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:ec.Z,description:"質問と回答のペアを作成"},{id:"multiple-choice",title:"多肢選択",icon:eo.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:ed.Z,description:"項目をカテゴリーに分類"}];return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"セットの作成・編集"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"新規作成または編集したい学習セットのタイプを選択してください。"}),(0,a.jsx)("div",{className:"grid gap-4",children:i.map(e=>(0,a.jsxs)(N,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(b,{className:"text-lg font-medium",children:e.title}),(0,a.jsx)(e.icon,{className:"h-6 w-6 text-gray-500"})]}),(0,a.jsxs)(y,{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(Z,{className:"w-full",onClick:()=>t(e.id),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," このタイプで作成"]}),(0,a.jsxs)(Z,{className:"w-full",variant:"outline",onClick:()=>l(e.id),children:[(0,a.jsx)(eh.Z,{className:"mr-2 h-4 w-4"})," このタイプを編集"]})]})]})]},e.id))})]})},ef=t(1543),ej=t(2421),eg=t(4392),ep=t(2468);let eN=ef.fC;ef.ZA;let ev=ef.B4,eb=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(ef.xz,{ref:s,className:p("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[l,(0,a.jsx)(ef.JO,{asChild:!0,children:(0,a.jsx)(ej.Z,{className:"h-4 w-4 opacity-50"})})]})});eb.displayName=ef.xz.displayName;let ey=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ef.u_,{ref:s,className:p("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(eg.Z,{className:"h-4 w-4"})})});ey.displayName=ef.u_.displayName;let ew=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ef.$G,{ref:s,className:p("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(ej.Z,{className:"h-4 w-4"})})});ew.displayName=ef.$G.displayName;let eC=l.forwardRef((e,s)=>{let{className:t,children:l,position:i="popper",...r}=e;return(0,a.jsx)(ef.h_,{children:(0,a.jsxs)(ef.VY,{ref:s,className:p("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...r,children:[(0,a.jsx)(ey,{}),(0,a.jsx)(ef.l_,{className:p("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,a.jsx)(ew,{})]})})});eC.displayName=ef.VY.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ef.__,{ref:s,className:p("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...l})}).displayName=ef.__.displayName;let eS=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(ef.ck,{ref:s,className:p("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(ef.wU,{children:(0,a.jsx)(ep.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(ef.eT,{children:l})]})});eS.displayName=ef.ck.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(ef.Z0,{ref:s,className:p("-mx-1 my-1 h-px bg-muted",t),...l})}).displayName=ef.Z0.displayName;var ek=t(8094),eZ=e=>{let{onBack:s,onStartQuiz:t}=e,[i,r]=(0,l.useState)({flashcard:[],qa:[],"multiple-choice":[],classification:[]}),[n,c]=(0,l.useState)({flashcard:"",qa:"","multiple-choice":"",classification:""});(0,l.useEffect)(()=>{(async()=>{try{let e=await m("flashcard"),s=await m("qa"),t=await m("multiple-choice"),a=await m("classification");r({flashcard:e,qa:s,"multiple-choice":t,classification:a})}catch(e){console.error("Error loading sets:",e)}})()},[]);let o=[{id:"flashcard",title:"フラッシュカード",icon:P.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:ec.Z,description:"質問と回答のペアで学習"},{id:"multiple-choice",title:"多肢選択",icon:eo.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:ed.Z,description:"項目をカテゴリーに分類"}],d=(e,s)=>{c(t=>({...t,[e]:s}))},x=e=>{var s,a,l;let r=n[e]||(null===(l=i[e])||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:null===(s=a.id)||void 0===s?void 0:s.toString());r&&t(e,parseInt(r,10))};return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"学習タイプを選択"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"学習したいクイズタイプとセットを選択し、「学習開始」ボタンをクリックしてください。"}),(0,a.jsx)("div",{className:"space-y-4",children:o.map(e=>{var s,t,l,r;return(0,a.jsxs)(N,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center space-y-0 pb-2",children:[(0,a.jsx)(b,{className:"text-lg font-medium",children:e.title}),(0,a.jsx)(e.icon,{className:"h-6 w-6 text-gray-500 ml-2"})]}),(0,a.jsxs)(y,{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e.description}),(0,a.jsxs)(eN,{onValueChange:s=>d(e.id,s),value:n[e.id]||(null===(l=i[e.id])||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:null===(s=t.id)||void 0===s?void 0:s.toString())||"",children:[(0,a.jsx)(eb,{className:"w-full",children:(0,a.jsx)(ev,{placeholder:"セットを選択"})}),(0,a.jsx)(eC,{children:null===(r=i[e.id])||void 0===r?void 0:r.map(e=>(0,a.jsx)(eS,{value:e.id.toString(),children:e.title},e.id))})]})]}),(0,a.jsx)(w,{children:(0,a.jsxs)(Z,{className:"w-full",onClick:()=>x(e.id),children:[(0,a.jsx)(ek.Z,{className:"mr-2 h-4 w-4"})," 学習開始"]})})]},e.id)})})]})};let ez=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:p("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});ez.displayName="Textarea";let eE=(0,S.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eq=l.forwardRef((e,s)=>{let{className:t,variant:l,...i}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:p(eE({variant:l}),t),...i})});eq.displayName="Alert",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h5",{ref:s,className:p("mb-1 font-medium leading-none tracking-tight",t),...l})}).displayName="AlertTitle";let eR=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:p("text-sm [&_p]:leading-relaxed",t),...l})});eR.displayName="AlertDescription";var eD=t(7019),eI=t(5733),eT=t(9061);function eF(){let e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let s=e.current;if(!s)return;let t=()=>{setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"center"})},100)};return s.addEventListener("focus",t),()=>{s.removeEventListener("focus",t)}},[]),e}var eA=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{front:"",back:"",image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eF(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},p=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),m(e),0===Object.keys(e).length},C=async()=>{if(p())try{let e={title:i,cards:n,type:"flashcard"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},S=e=>{h(x===e?null:e)};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(es,{ref:u,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>S(s),children:x===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>j(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,a.jsx)("p",{children:e.front}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Card front",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,a.jsx)("p",{children:e.back})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{ref:u,placeholder:"表面",value:e.front,onChange:e=>f(s,"front",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(ez,{ref:u,placeholder:"裏面",value:e.back,onChange:e=>f(s,"back",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(es,{ref:u,type:"file",accept:"image/*",onChange:e=>g(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(w,{children:o["card".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["card".concat(s)]})})})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{c([...n,{front:"",back:"",image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,a.jsxs)(Z,{onClick:C,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eM=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,j]=(0,l.useState)([]),[g,p]=(0,l.useState)({}),[C,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("flashcard");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let k=async e=>{c(e);try{let s=await h(parseInt(e));console.log("Retrieved set:",s),d(s.title),Array.isArray(s.cards)&&s.cards.length>0?(j(s.cards),console.log("Cards set:",s.cards)):(j([]),console.log("No cards found or invalid card data"))}catch(e){console.error("Error loading set:",e),j([])}},z=(e,s,t)=>{j(x.map((a,l)=>l===e?{...a,[s]:t}:a))},E=e=>{j(x.filter((s,t)=>t!==e))},q=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{z(e,"image",s.result)},s.readAsDataURL(t)}},R=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),p(e),0===Object.keys(e).length},D=async()=>{if(R())try{let e={id:parseInt(n),title:o,cards:x,type:"flashcard"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}},I=e=>{S(C===e?null:e)},T=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await f(parseInt(n)),s()}catch(e){console.error("Error deleting set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(eN,{onValueChange:k,value:n,children:[(0,a.jsx)(eb,{className:"w-full",children:(0,a.jsx)(ev,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(eC,{children:i.map(e=>(0,a.jsx)(eS,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(es,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),g.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g.title})}),n&&(0,a.jsxs)(Z,{onClick:T,variant:"destructive",className:"mt-2",children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),x&&x.length>0?x.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>I(s),children:C===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>E(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:C===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,a.jsx)("p",{children:e.front}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Card image",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,a.jsx)("p",{children:e.back})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{placeholder:"表面",value:e.front,onChange:e=>z(s,"front",e.target.value),className:"mb-2"}),(0,a.jsx)(es,{type:"file",accept:"image/*",onChange:e=>q(s,e),className:"mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded image",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)(ez,{placeholder:"裏面",value:e.back,onChange:e=>z(s,"back",e.target.value),className:"mt-4 mb-2"})]})}),(0,a.jsx)(w,{children:g["card".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["card".concat(s)]})})})]},s)):(0,a.jsx)("p",{children:n?"このセットにはカードがありません。新しいカードを追加してください。":"セットを選択するか、新しいカードを追加してください。"}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{j([...x,{front:"",back:"",image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,a.jsxs)(Z,{onClick:D,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},e_=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{question:"",answer:"",image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eF(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},p=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),m(e),0===Object.keys(e).length},C=async()=>{if(p())try{let e={title:i,qaItems:n,type:"qa"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},S=e=>{h(x===e?null:e)};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(es,{ref:u,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>S(s),children:x===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>j(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,a.jsx)("p",{children:e.answer})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{ref:u,placeholder:"質問",value:e.question,onChange:e=>f(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(ez,{ref:u,placeholder:"回答",value:e.answer,onChange:e=>f(s,"answer",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(es,{ref:u,type:"file",accept:"image/*",onChange:e=>g(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(w,{children:o["item".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["item".concat(s)]})})})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{c([...n,{question:"",answer:"",image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(Z,{onClick:C,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eO=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,j]=(0,l.useState)([{question:"",answer:"",image:null}]),[g,p]=(0,l.useState)({}),[C,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("qa");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let k=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),j(s.qaItems)}catch(e){console.error("Error loading set:",e)}},z=(e,s,t)=>{j(x.map((a,l)=>l===e?{...a,[s]:t}:a))},E=e=>{j(x.filter((s,t)=>t!==e))},q=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{z(e,"image",s.result)},s.readAsDataURL(t)}},R=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),p(e),0===Object.keys(e).length},D=async()=>{if(R())try{let e={id:parseInt(n),title:o,qaItems:x,type:"qa"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}},I=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await f(parseInt(n)),s()}catch(e){console.error("Error deleting set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(eN,{onValueChange:k,value:n,children:[(0,a.jsx)(eb,{className:"w-full",children:(0,a.jsx)(ev,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(eC,{children:i.map(e=>(0,a.jsx)(eS,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(es,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),g.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g.title})}),n&&(0,a.jsxs)(Z,{onClick:I,variant:"destructive",className:"mt-2",children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),x.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>S(C===s?null:s),children:C===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>E(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:C===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,a.jsx)("p",{children:e.answer})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{placeholder:"質問",value:e.question,onChange:e=>z(s,"question",e.target.value),className:"mb-2"}),(0,a.jsx)(ez,{placeholder:"回答",value:e.answer,onChange:e=>z(s,"answer",e.target.value),className:"mb-2"}),(0,a.jsx)(es,{type:"file",accept:"image/*",onChange:e=>q(s,e),className:"mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(w,{children:g["item".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["item".concat(s)]})})})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{j([...x,{question:"",answer:"",image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(Z,{onClick:D,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eB=t(9324);let eL=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eB.fC,{ref:s,className:p("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...l,children:(0,a.jsx)(eB.z$,{className:p("flex items-center justify-center text-current"),children:(0,a.jsx)(ep.Z,{className:"h-4 w-4"})})})});eL.displayName=eB.fC.displayName;var eV=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eF(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=e=>{c(n.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},p=(e,s,t,a)=>{c(n.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},C=(e,s)=>{c(n.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},S=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},k=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),m(e),0===Object.keys(e).length},z=async()=>{if(k())try{let e={title:i,questions:n,type:"multiple-choice"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},E=e=>{h(x===e?null:e)};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(es,{placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>E(s),children:x===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>j(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,a.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{ref:u,placeholder:"問題文",value:e.question,onChange:e=>f(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(es,{ref:u,type:"file",accept:"image/*",onChange:e=>S(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(eL,{ref:u,checked:e.isCorrect,onCheckedChange:e=>p(s,t,"isCorrect",e),className:"mr-2"}),(0,a.jsx)(es,{ref:u,placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>p(s,t,"text",e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>C(s,t),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(Z,{onClick:()=>g(s),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,a.jsxs)(w,{children:[o["question".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["question".concat(s)]})}),o["question".concat(s,"choices")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["question".concat(s,"choices")]})}),o["question".concat(s,"correct")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["question".concat(s,"correct")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{c([...n,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(Z,{onClick:z,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eP=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,j]=(0,l.useState)([]),[g,p]=(0,l.useState)({}),[C,S]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("multiple-choice");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let k=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),j(s.questions)}catch(e){console.error("Error loading set:",e)}},z=(e,s,t)=>{j(x.map((a,l)=>l===e?{...a,[s]:t}:a))},E=e=>{j(x.filter((s,t)=>t!==e))},q=e=>{j(x.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},R=(e,s,t,a)=>{j(x.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},D=(e,s)=>{j(x.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},I=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{z(e,"image",s.result)},s.readAsDataURL(t)}},T=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),p(e),0===Object.keys(e).length},F=async()=>{if(T())try{let e={id:parseInt(n),title:o,questions:x,type:"multiple-choice"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}},A=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await f(parseInt(n)),s()}catch(e){console.error("Error deleting set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(eN,{onValueChange:k,value:n,children:[(0,a.jsx)(eb,{className:"w-full",children:(0,a.jsx)(ev,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(eC,{children:i.map(e=>(0,a.jsx)(eS,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(es,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),g.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g.title})}),n&&(0,a.jsxs)(Z,{onClick:A,variant:"destructive",className:"mt-2",children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),x.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>S(C===s?null:s),children:C===s?(0,a.jsx)(eD.Z,{className:"h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"h-4 w-4"})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>E(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(y,{children:C===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,a.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ez,{placeholder:"問題文",value:e.question,onChange:e=>z(s,"question",e.target.value),className:"mb-2"}),(0,a.jsx)(es,{type:"file",accept:"image/*",onChange:e=>I(s,e),className:"mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(eL,{checked:e.isCorrect,onCheckedChange:e=>R(s,t,"isCorrect",e),className:"mr-2"}),(0,a.jsx)(es,{placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>R(s,t,"text",e.target.value),className:"flex-grow mr-2"}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>D(s,t),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(Z,{onClick:()=>q(s),className:"mt-2",children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,a.jsxs)(w,{children:[g["question".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["question".concat(s)]})}),g["question".concat(s,"choices")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["question".concat(s,"choices")]})}),g["question".concat(s,"correct")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["question".concat(s,"correct")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{j([...x,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(Z,{onClick:F,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eU=t(8184),eQ=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{name:"",items:[""]}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(!1),[u,f]=(0,l.useState)(Array(6).fill(null)),j=eF(),g=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},p=e=>{c(n.filter((s,t)=>t!==e))},C=e=>{c(n.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},S=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},k=(e,s)=>{c(n.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},z=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onload=s=>{let t=[...u];t[e]=s.target.result,f(t)},s.readAsDataURL(t)}},E=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.name.trim()||u[t]||(e["category".concat(t)]="カテゴリー名または画像を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),m(e),0===Object.keys(e).length},q=async()=>{if(E())try{let e={title:i,categories:n.map((e,s)=>({...e,image:u[s]})),type:"classification"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(es,{ref:j,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o.title})})]}),(0,a.jsxs)(Z,{onClick:()=>h(!x),children:[x?(0,a.jsx)(eD.Z,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"mr-2 h-4 w-4"}),x?"プレビューを終了":"プレビュー"]}),x?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:i}),n.map((e,s)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold",children:e.name}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]},s))]}):n.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("label",{htmlFor:"image-upload-".concat(s),className:"cursor-pointer mr-2",children:[(0,a.jsx)(eU.Z,{className:"h-4 w-4"}),(0,a.jsx)("input",{id:"image-upload-".concat(s),type:"file",accept:"image/*",className:"hidden",onChange:e=>z(s,e)})]}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>p(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)(y,{children:[u[s]&&(0,a.jsx)("img",{src:u[s],alt:"Category",className:"w-full h-32 object-cover mb-2"}),(0,a.jsx)(es,{ref:j,placeholder:"カテゴリー名",value:e.name,onChange:e=>g(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)(es,{ref:j,placeholder:"項目 ".concat(t+1),value:e,onChange:e=>S(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>k(s,t),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(Z,{onClick:()=>C(s),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,a.jsxs)(w,{children:[o["category".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["category".concat(s)]})}),o["category".concat(s,"items")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:o["category".concat(s,"items")]})})]})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{n.length<6&&c([...n,{name:"",items:[""]}])},disabled:n.length>=6,children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,a.jsxs)(Z,{onClick:q,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eH=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,j]=(0,l.useState)([{name:"",items:[""]}]),[g,p]=(0,l.useState)({}),[C,S]=(0,l.useState)(!1),[k,z]=(0,l.useState)(Array(6).fill(null));(0,l.useEffect)(()=>{(async()=>{try{let e=await m("classification");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let E=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),j(s.categories),z(s.categories.map(e=>e.image||null))}catch(e){console.error("Error loading set:",e)}},q=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onload=s=>{let t=[...k];t[e]=s.target.result,z(t)},s.readAsDataURL(t)}},R=(e,s,t)=>{j(x.map((a,l)=>l===e?{...a,[s]:t}:a))},D=e=>{j(x.filter((s,t)=>t!==e))},I=e=>{j(x.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},T=(e,s,t)=>{j(x.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},F=(e,s)=>{j(x.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},A=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.name.trim()||k[t]||(e["category".concat(t)]="カテゴリー名または画像を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),p(e),0===Object.keys(e).length},M=async()=>{if(A())try{let e={id:parseInt(n),title:o,categories:x.map((e,s)=>({...e,image:k[s]})),type:"classification"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}},_=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await f(parseInt(n)),s()}catch(e){console.error("Error deleting set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(eN,{onValueChange:E,value:n,children:[(0,a.jsx)(eb,{className:"w-full",children:(0,a.jsx)(ev,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(eC,{children:i.map(e=>(0,a.jsx)(eS,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(es,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),g.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g.title})}),n&&(0,a.jsxs)(Z,{onClick:_,variant:"destructive",className:"mt-2",children:[(0,a.jsx)(ei.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),(0,a.jsxs)(Z,{onClick:()=>S(!C),className:"mb-4",children:[C?(0,a.jsx)(eD.Z,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(eI.Z,{className:"mr-2 h-4 w-4"}),C?"プレビューを終了":"プレビュー"]}),C?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:o}),x.map((e,s)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold",children:e.name}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]},s))]}):x.map((e,s)=>(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsxs)(v,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(b,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("label",{htmlFor:"image-upload-".concat(s),className:"cursor-pointer mr-2",children:[(0,a.jsx)(eU.Z,{className:"h-4 w-4"}),(0,a.jsx)("input",{id:"image-upload-".concat(s),type:"file",accept:"image/*",className:"hidden",onChange:e=>q(s,e)})]}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>D(s),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)(y,{children:[k[s]&&(0,a.jsx)("img",{src:k[s],alt:"Category",className:"w-full h-32 object-cover mb-2"}),(0,a.jsx)(es,{placeholder:"カテゴリー名",value:e.name,onChange:e=>R(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)(es,{placeholder:"項目 ".concat(t+1),value:e,onChange:e=>T(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>F(s,t),children:(0,a.jsx)(ei.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(Z,{onClick:()=>I(s),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,a.jsxs)(w,{children:[g["category".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["category".concat(s)]})}),g["category".concat(s,"items")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eR,{children:g["category".concat(s,"items")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(Z,{onClick:()=>{x.length<6&&j([...x,{name:"",items:[""]}])},disabled:x.length>=6,children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,a.jsxs)(Z,{onClick:M,children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eY=t(3522),eG=t(1976),eW=t(6753),e$=t(7662),eJ=t.n(e$);let eX=e=>{let{content:s,image:t}=e;return(0,a.jsxs)("div",{className:"text-center w-full",children:[(0,a.jsx)("p",{className:"mb-4 text-lg",children:s}),t&&(0,a.jsx)("div",{className:"mt-4 flex justify-center",children:(0,a.jsx)("img",{src:t,alt:"Flashcard image",className:"max-w-full h-auto max-h-[200px] object-contain rounded-md"})})]})};var eK=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[x,u]=(0,l.useState)([]),[f,j]=(0,l.useState)(0),[g,p]=(0,l.useState)(!1),[N,v]=(0,l.useState)([]),[b,y]=(0,l.useState)(!0),[w,C]=(0,l.useState)(null),S=(0,l.useRef)(new Date),k=()=>{let e=x.length;return Math.round(N.filter(Boolean).length/e*100)},z=e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s};(0,l.useEffect)(()=>{(async()=>{try{y(!0);let e=[];if(e=null===i?(await m("flashcard")).flatMap(e=>e.cards):(await h(parseInt(i))).cards,Array.isArray(e)){d(e);let s=z(e);u(s),v(Array(s.length).fill(!1))}else throw Error("Invalid data structure")}catch(e){console.error("Error loading flashcards:",e),C("フラッシュカードの読み込み中にエラーが発生しました。")}finally{y(!1)}})()},[i]);let E=()=>{f<x.length-1&&(j(f+1),p(!1))},q=async()=>{let e=k(),t=new Date,a=Math.round((t-S.current)/1e3);await c(i,r,"flashcard",e,t,a),s(e)};if(b)return(0,a.jsx)("div",{children:"読み込み中..."});if(w)return(0,a.jsx)("div",{children:w});if(0===x.length)return(0,a.jsx)("div",{children:"フラッシュカードがありません。"});let R=x[f];return(0,a.jsxs)("div",{className:"p-2 w-full max-w-[390px] mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"フラッシュカード"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>{let e=z(o);u(e),j(0),p(!1),v(Array(e.length).fill(!1))},className:"mr-2",children:(0,a.jsx)(eY.Z,{})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:q,children:"終了"})]})]}),(0,a.jsx)("div",{className:eJ().flashcardContainer,onClick:()=>{p(!g)},children:(0,a.jsxs)("div",{className:"".concat(eJ().flashcard," ").concat(g?eJ().flipped:""),children:[(0,a.jsx)("div",{className:eJ().front,children:(0,a.jsx)(eX,{content:R.front,image:R.image})}),(0,a.jsx)("div",{className:eJ().back,children:(0,a.jsx)(eX,{content:R.back})})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)(Z,{onClick:()=>{f>0&&(j(f-1),p(!1))},disabled:0===f,children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 前へ"]}),(0,a.jsxs)("span",{children:[f+1," / ",x.length]}),(0,a.jsxs)(Z,{onClick:E,disabled:f===x.length-1,children:["次へ ",(0,a.jsx)(eG.Z,{className:"ml-2 h-4 w-4"})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-center",children:(0,a.jsxs)(Z,{onClick:()=>{let e=[...N];e[f]=!0,v(e),E()},className:"mr-2",children:[(0,a.jsx)(eW.Z,{className:"mr-2 h-4 w-4"})," 覚えた"]})})]})},e0=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[x,u]=(0,l.useState)(0),[f,j]=(0,l.useState)(""),[g,p]=(0,l.useState)(!1),[C,S]=(0,l.useState)([]),[k,z]=(0,l.useState)(!0),[E,q]=(0,l.useState)(null),[R,D]=(0,l.useState)(!1),[I,T]=(0,l.useState)([]),F=(0,l.useRef)(new Date);(0,l.useEffect)(()=>{(async()=>{try{z(!0);let e=[];if(e=null===i?(await m("qa")).flatMap(e=>e.qaItems):(await h(parseInt(i))).qaItems,Array.isArray(e))d(e),T(A([...e])),S(Array(e.length).fill(null));else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),q("質問の読み込み中にエラーが発生しました。")}finally{z(!1)}})()},[i]);let A=e=>{for(let s=e.length-1;s>0;s--){let t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e},M=(0,l.useCallback)(()=>{let e=f.toLowerCase()===I[x].answer.toLowerCase(),s=[...C];s[x]=e,S(s),p(!0),D(x===I.length-1),x<I.length-1&&setTimeout(()=>{u(e=>e+1),j(""),p(!1)},1e3)},[f,I,x,C]),_=async()=>{let e=O(),t=new Date,a=Math.round((t-F.current)/1e3);await c(i,r,"qa",e,t,a),s(e)},O=()=>{let e=I.length;return Math.round(C.filter(Boolean).length/e*100)};if(k)return(0,a.jsx)("div",{children:"読み込み中..."});if(E)return(0,a.jsx)("div",{children:E});if(0===I.length)return(0,a.jsx)("div",{children:"質問がありません。"});let B=I[x];return(0,a.jsx)("div",{className:"mobile-friendly-form",children:(0,a.jsxs)("div",{className:"scrollable-content p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"一問一答"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>{T(A([...I])),u(0),j(""),p(!1),S(Array(I.length).fill(null))},children:(0,a.jsx)(eY.Z,{})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:_,children:"終了"})]})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsx)(b,{className:"text-lg",children:B.question})}),(0,a.jsxs)(y,{children:[B.image&&(0,a.jsx)("img",{src:B.image,alt:"Question",className:"w-full mb-4 max-h-48 object-contain"}),(0,a.jsx)(es,{type:"text",placeholder:"回答を入力",value:f,onChange:e=>j(e.target.value),disabled:g})]}),(0,a.jsx)(w,{className:"flex justify-between",children:g?(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[C[x]?(0,a.jsx)(ep.Z,{className:"text-green-500 mr-2"}):(0,a.jsx)(H.Z,{className:"text-red-500 mr-2"}),(0,a.jsxs)("span",{children:["正解: ",B.answer]})]}):(0,a.jsx)(Z,{onClick:M,children:"回答する"})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{children:[x+1," / ",I.length]})})]})})},e4=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[m,x]=(0,l.useState)([]),[u,f]=(0,l.useState)(0),[j,g]=(0,l.useState)([]),[p,C]=(0,l.useState)(!1),[S,k]=(0,l.useState)([]),[z,E]=(0,l.useState)(!0),[q,R]=(0,l.useState)(null),[D,I]=(0,l.useState)(!1),T=(0,l.useRef)(new Date),F=()=>{let e=m.length;return Math.round(S.filter(Boolean).length/e*100)},A=e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},M=e=>({...e,choices:A(e.choices)});(0,l.useEffect)(()=>{(async()=>{try{E(!0);let e=[];if(e=null===i?(await getSets("multiple-choice")).flatMap(e=>e.questions):(await h(parseInt(i))).questions,Array.isArray(e)){d(e);let s=e.map(M),t=A(s);x(t),k(Array(t.length).fill(null))}else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),R("質問の読み込み中にエラーが発生しました。")}finally{E(!1)}})()},[i]);let _=e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},O=(0,l.useCallback)(()=>{if(j.length>0&&u<m.length){let e=m[u].choices.every((e,s)=>j.includes(s)===e.isCorrect),s=[...S];s[u]=e,k(s),C(!0),I(u===m.length-1),u<m.length-1&&setTimeout(()=>{f(e=>e+1),g([]),C(!1)},1e3)}},[j,u,m,S]),B=async()=>{let e=F(),t=new Date,a=Math.round((t-T.current)/1e3);await c(i,r,"multiple-choice",e,t,a),s(e)};if(z)return(0,a.jsx)("div",{children:"読み込み中..."});if(q)return(0,a.jsx)("div",{children:q});if(0===m.length)return(0,a.jsx)("div",{children:"質問がありません。"});let L=m[u];return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"多肢選択問題"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:()=>{let e=A(o.map(M));x(e),f(0),g([]),C(!1),k(Array(e.length).fill(null)),I(!1)},className:"mr-2",children:(0,a.jsx)(eY.Z,{})}),(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:B,children:"終了"})]})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsx)(b,{children:L.question})}),(0,a.jsxs)(y,{children:[L.image&&(0,a.jsx)("img",{src:L.image,alt:"Question",className:"w-full mb-4"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:L.choices.map((e,s)=>(0,a.jsx)(Z,{variant:j.includes(s)?"default":"outline",className:"justify-start ".concat(p&&e.isCorrect?"bg-green-100":""),onClick:()=>!p&&_(s),disabled:p,children:e.text},s))})]}),(0,a.jsx)(w,{className:"flex justify-between",children:p?(0,a.jsxs)("div",{className:"flex items-center",children:[S[u]?(0,a.jsx)(ep.Z,{className:"text-green-500 mr-2"}):(0,a.jsx)(H.Z,{className:"text-red-500 mr-2"}),(0,a.jsxs)("span",{children:["正解: ",L.choices.filter(e=>e.isCorrect).map(e=>e.text).join(", ")]})]}):(0,a.jsx)(Z,{onClick:O,disabled:0===j.length,children:"回答する"})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{children:[u+1," / ",m.length]})})]})},e2=t(5149),e1=t(5392),e6=t(5554);let e3=(0,l.memo)(e=>{let{id:s,children:t,isDragging:i,isClassified:r}=e,{attributes:n,listeners:c,setNodeRef:o,transform:d,transition:m}=(0,e1.nB)({id:s}),x=(0,l.useMemo)(()=>({transform:e6.ux.Transform.toString(d),transition:m,opacity:i?.5:1}),[d,m,i]);return(0,a.jsx)("div",{ref:o,style:x,...n,...c,className:"inline-block p-2 m-1 rounded border ".concat(r?"bg-gray-100":"bg-white"," ").concat(i?"shadow-lg":"shadow"),children:t})});e3.displayName="SortableItem";let e5=(0,l.memo)(e=>{let{category:s,isActive:t,feedbackColor:i}=e,{setNodeRef:r}=(0,e2.Zj)({id:s.name,data:{category:s.name}}),n=(0,l.useMemo)(()=>"\n    flex flex-col items-center justify-center rounded transition-all duration-300\n    ".concat(i||"bg-gray-100","\n    ").concat(t?"border-2 border-blue-500":"","\n    w-full h-full\n  "),[i,t]);return(0,a.jsxs)("div",{ref:r,className:n,children:[s.image&&(0,a.jsx)("img",{src:s.image,alt:s.name,className:"w-full h-24 object-cover mb-2"}),(0,a.jsx)("h3",{className:"text-center",style:{writingMode:"vertical-rl",textOrientation:"upright"},children:s.name})]})});e5.displayName="DroppableCategory";var e9=e=>{var s;let{onFinish:t,onBack:i,setId:r,title:n,quizType:c}=e,[o,d]=(0,l.useState)({question:null,categories:[],items:[],correctClassification:{},isFinished:!1,showResults:!1,score:0}),[m,x]=(0,l.useState)(!0),[u,f]=(0,l.useState)(null),[j,g]=(0,l.useState)(null),[p,v]=(0,l.useState)(null),[b,w]=(0,l.useState)({}),[C,S]=(0,l.useState)({}),[k,z]=(0,l.useState)([]),[E,q]=(0,l.useState)({}),[R,D]=(0,l.useState)([]),[I,T]=(0,l.useState)([]);(0,l.useRef)(new Date);let{width:F,height:A}=function(){let[e,s]=(0,l.useState)({width:void 0,height:void 0});return(0,l.useEffect)(()=>{function e(){s({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}();(0,l.useEffect)(()=>{k.length>0&&D(k)},[k]);let M=(0,e2.Dy)((0,e2.VT)(e2.we,{activationConstraint:{distance:8,delay:100,tolerance:5}}));(0,l.useEffect)(()=>{let e=e=>e.preventDefault();return document.addEventListener("touchmove",e,{passive:!1}),()=>document.removeEventListener("touchmove",e)},[]),(0,l.useEffect)(()=>{(async()=>{try{x(!0);let e=await h(parseInt(r));if(e&&Array.isArray(e.categories)){let s=e.categories.flatMap(e=>e.items.map((s,t)=>({id:"".concat(e.name,"-").concat(t),content:s,category:null,isClassified:!1}))),t=_(s),a=e.categories.reduce((e,s)=>(e[s.name]=s.items,e),{});d({question:null,categories:e.categories,items:s,correctClassification:a,isFinished:!1,showResults:!1,score:0}),z(t),T(_(e.categories))}else throw Error("Invalid data structure")}catch(e){console.error("Error loading question:",e),f("質問の読み込中にエラーが発生しまた。")}finally{x(!1)}})()},[r]);let _=e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},O=(0,l.useCallback)(()=>{z(_(k)),T(_(I))},[k,I]),B=(0,l.useCallback)(e=>{let{active:s}=e;g(s.id)},[]),L=(0,l.useCallback)(e=>{let{over:s}=e;v(s?s.id:null)},[]),V=(0,l.useCallback)(e=>{let{active:s,over:t}=e;t&&s.id!==t.id&&d(e=>{var a;let l=e.items.map(e=>e.id===s.id?{...e,category:t.id,isClassified:!0}:e);q(e=>({...e,[t.id]:[...e[t.id]||[],s.id]}));let i=l.filter(e=>e.isClassified).length,r=l.filter(s=>{var t;return s.isClassified&&(null===(t=e.correctClassification[s.category])||void 0===t?void 0:t.includes(s.content))}).length,n=l.every(e=>e.isClassified),c=null===(a=e.correctClassification[t.id])||void 0===a?void 0:a.includes(l.find(e=>e.id===s.id).content);return S(e=>({...e,[t.id]:c?"bg-green-200":"bg-red-200"})),D(e=>e.filter(e=>e.id!==s.id)),{...e,items:l,score:i>0?Math.round(r/i*100):0,isFinished:n,showResults:n}}),g(null),v(null)},[]);(0,l.useEffect)(()=>{if(Object.keys(C).length>0){let e=setTimeout(()=>{S({})},500);return()=>clearTimeout(e)}},[C]);let P=(0,l.useCallback)(()=>{d(e=>({...e,isFinished:!1,showResults:!1,score:0})),D(k),q({}),S({})},[k]),U=(0,l.useCallback)(()=>{t(o.score)},[t,o.score]),Q=(0,l.useCallback)(()=>{let e=F-180,s=A-150;return{gridTemplateColumns:"repeat(".concat(4,", ").concat(Math.floor(e/4),"px)"),gridTemplateRows:"repeat(".concat(2,", ").concat(Math.floor(s/2),"px)"),gap:"1rem"}},[F,A]),H=(0,l.useMemo)(()=>Q(),[Q]);return m?(0,a.jsx)("div",{children:"読み込み中..."}):u?(0,a.jsx)("div",{children:u}):(0,a.jsxs)("div",{className:"flex",style:{width:"".concat(F,"px"),height:"".concat(A,"px"),maxWidth:"100vw",maxHeight:"100vh"},children:[(0,a.jsx)("div",{className:"flex flex-col justify-between p-4 w-20",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-between h-full",children:[(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-32",children:(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:i,children:(0,a.jsx)(em.Z,{})})}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-32 text-center",children:[(0,a.jsx)("span",{className:"text-xl font-bold whitespace-nowrap",children:"分類"}),(0,a.jsx)("span",{className:"text-xl font-bold whitespace-nowrap",children:"クイズ"})]}),(0,a.jsx)("div",{className:"flex flex-col items-center justify-center h-32",children:(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:O,children:(0,a.jsx)(eY.Z,{})})}),(0,a.jsx)(()=>(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-32",children:[(0,a.jsx)("div",{className:"writing-vertical-rl text-lg font-bold mb-2 whitespace-nowrap",children:"スコア"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-lg font-bold mr-1",children:":"}),(0,a.jsxs)("span",{className:"text-lg font-bold",children:[o.score,"%"]})]})]}),{}),o.showResults]})}),(0,a.jsx)("div",{className:"flex-grow p-4",children:(0,a.jsx)(N,{className:"h-full",children:(0,a.jsx)(y,{className:"h-full relative p-4",children:o.showResults?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4",children:["最終スコア: ",o.score,"%"]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(Z,{onClick:P,children:"もう一度挑戦"}),(0,a.jsx)(Z,{onClick:U,children:"終了"})]})]}):(0,a.jsxs)(e2.LB,{sensors:M,onDragStart:B,onDragOver:L,onDragEnd:V,children:[(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"grid mb-4",style:H,children:I.map(e=>(0,a.jsx)(e5,{category:e,isActive:p===e.name,feedbackColor:C[e.name]||b[e.name]},e.name))}),(0,a.jsx)("div",{className:"flex-grow"}),(0,a.jsx)("div",{className:"flex justify-center",children:R.length>0&&(0,a.jsx)(e1.Fo,{items:[R[0]],strategy:e1.qw,children:(0,a.jsx)(e3,{id:R[0].id,isDragging:R[0].id===j,isClassified:!1,children:R[0].content},R[0].id)})})]}),(0,a.jsx)(e2.y9,{children:j?(0,a.jsx)("div",{className:"bg-white p-2 rounded border shadow-lg",children:null===(s=o.items.find(e=>e.id===j))||void 0===s?void 0:s.content}):null})]})})})})]})},e8=e=>{let{onBack:s,overallProgress:t,streak:l,studyHistory:i,dailyGoal:r,todayStudyTime:n}=e;return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(Z,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(em.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"学習統計"})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsxs)(b,{className:"flex items-center",children:[(0,a.jsx)(L.Z,{className:"mr-2 text-blue-500",size:24}),"全体の進捗"]})}),(0,a.jsxs)(y,{children:[(0,a.jsx)(E,{value:t,className:"w-full"}),(0,a.jsxs)("p",{className:"text-center mt-2 font-bold",children:[t.toFixed(1),"%"]})]})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsxs)(b,{className:"flex items-center",children:[(0,a.jsx)(B.Z,{className:"mr-2 text-yellow-500",size:24}),"学習継続日数"]})}),(0,a.jsxs)(y,{children:[(0,a.jsxs)("p",{className:"text-lg font-bold",children:["現在のストリーク: ",l,"日"]}),(0,a.jsxs)("p",{children:["過去最高ストリーク: ",10,"日"]})]})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsxs)(b,{className:"flex items-center",children:[(0,a.jsx)(U.Z,{className:"mr-2 text-green-500",size:24}),"今日の学習時間"]})}),(0,a.jsxs)(y,{children:[(0,a.jsx)(E,{value:n/r*100,className:"w-full mb-2"}),(0,a.jsxs)("p",{children:[n,"分 / ",r,"分"]})]})]}),(0,a.jsxs)(N,{className:"mb-4",children:[(0,a.jsx)(v,{children:(0,a.jsxs)(b,{className:"flex items-center",children:[(0,a.jsx)(P.Z,{className:"mr-2 text-purple-500",size:24}),"最近の学習"]})}),(0,a.jsx)(y,{children:(0,a.jsx)("ul",{className:"space-y-2",children:i.slice(0,5).map((e,s)=>(0,a.jsxs)("li",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:e.setTitle}),(0,a.jsxs)("span",{children:[e.score,"%"]})]},s))})})]})]})};function e7(){let{hashPath:e,push:s,isReady:t}=function(){let[e,s]=(0,l.useState)(""),[t,a]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=()=>{let e=window.location.hash.slice(1);console.log("Hash changed to:",e),s(e)};return e(),window.addEventListener("hashchange",e),a(!0),()=>{window.removeEventListener("hashchange",e)}},[]),{hashPath:e,push:e=>{console.log("Pushing path:",e),window.location.hash=e},isReady:t}}(),[i,r]=(0,l.useState)("home"),[n,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[u,f]=(0,l.useState)(null),[j,g]=(0,l.useState)(null),[p,N]=(0,l.useState)(0),[v,b]=(0,l.useState)(0),[y,w]=(0,l.useState)([]),[C,S]=(0,l.useState)(60),[k,Z]=(0,l.useState)(0);(0,l.useEffect)(()=>{t&&!e&&s("home")},[t,e,s]),(0,l.useEffect)(()=>{console.log("Current hash path:",e);let[s,t]=e.split("/");switch(s){case"":case"home":default:r("home");break;case"createEditSet":r("createEditSet");break;case"quizTypeSelection":r("quizTypeSelection");break;case"flashcard":case"qa":case"multiple-choice":case"classification":c(s),r("edit"===t?"".concat(s,"Edit"):"".concat(s,"Creation"));break;case"quiz":r("quiz");break;case"statistics":r("statistics")}},[e]);let z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log("Navigating to:",e,t),s(t?"".concat(e,"/").concat(t):e)},E=()=>{z("createEditSet")},q=()=>{console.log("handleStartLearning called"),z("quizTypeSelection")},R=()=>{z("statistics")},D=e=>{c(e),z(e,"creation")},I=e=>{c(e),z(e,"edit")},T=async(e,s)=>{x(e),f(s);try{if(null===s)g("すべてのセット");else{let e=await h(s);g(e.title)}z("quiz")}catch(e){console.error("Error fetching set title:",e)}},F=e=>{console.log("Saving data:",e),z("home")},A=e=>{console.log("Quiz finished with results:",e),z("home")};return t?(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-4",children:(()=>{switch(console.log("Rendering screen:",i),i){case"home":return(0,a.jsx)(en,{onCreateSet:E,onStartLearning:q,onShowStatistics:R,overallProgress:p,setOverallProgress:N,streak:v,setStreak:b,studyHistory:y,setStudyHistory:w,dailyGoal:C,setDailyGoal:S,todayStudyTime:k,setTodayStudyTime:Z});case"createEditSet":return(0,a.jsx)(eu,{onBack:()=>z("home"),onSelectType:D,onEditType:I});case"quizTypeSelection":return(0,a.jsx)(eZ,{onBack:()=>z("home"),onStartQuiz:T});case"flashcardCreation":return(0,a.jsx)(eA,{onBack:()=>z("createEditSet"),onSave:F});case"flashcardEdit":return(0,a.jsx)(eM,{onBack:()=>z("createEditSet"),onSave:F});case"qaCreation":return(0,a.jsx)(e_,{onBack:()=>z("createEditSet"),onSave:F});case"qaEdit":return(0,a.jsx)(eO,{onBack:()=>z("createEditSet"),onSave:F});case"multiple-choiceCreation":return(0,a.jsx)(eV,{onBack:()=>z("createEditSet"),onSave:F});case"multiple-choiceEdit":return(0,a.jsx)(eP,{onBack:()=>z("createEditSet"),onSave:F});case"classificationCreation":return(0,a.jsx)(eQ,{onBack:()=>z("createEditSet"),onSave:F});case"classificationEdit":return(0,a.jsx)(eH,{onBack:()=>z("createEditSet"),onSave:F});case"quiz":switch(m){case"flashcard":return(0,a.jsx)(eK,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"qa":return(0,a.jsx)(e0,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"multiple-choice":return(0,a.jsx)(e4,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"classification":return(0,a.jsx)(e9,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});default:return null}case"statistics":return(0,a.jsx)(e8,{onBack:()=>z("home"),overallProgress:p,streak:v,studyHistory:y,dailyGoal:C,todayStudyTime:k});default:return(0,a.jsxs)("div",{children:["Unknown screen: ",i]})}})()}):null}function se(){return(0,a.jsx)(e7,{})}},7662:function(e){e.exports={flashcardContainer:"FlashcardQuiz_flashcardContainer__aqgvO",flashcard:"FlashcardQuiz_flashcard__08I4i",flipped:"FlashcardQuiz_flipped__cz657",front:"FlashcardQuiz_front__NwySn",back:"FlashcardQuiz_back__OO3St"}}},function(e){e.O(0,[947,935,971,23,744],function(){return e(e.s=4990)}),_N_E=e.O()}]);