(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4990:function(e,s,t){Promise.resolve().then(t.bind(t,6863))},6863:function(e,s,t){"use strict";let a;t.r(s),t.d(s,{default:function(){return sp}});var l={};t.r(l);var i=t(7437),r=t(2265),c=t(5236),n=t(9842),o=t(5735),d=t(9675);console.log("Firebase Config:",{apiKey:"AIzaSyCbfNQnSX7q8_yyrMIhFXn51qfTZxidwbs",authDomain:"memorize-cb9a7.firebaseapp.com",projectId:"memorize-cb9a7",storageBucket:"memorize-cb9a7.appspot.com",messagingSenderId:"680712601487",appId:"1:680712601487:web:8e601113591735f05395fa",measurementId:"G-G8RP2C41BN"});try{a=(0,c.ZF)({apiKey:"AIzaSyCbfNQnSX7q8_yyrMIhFXn51qfTZxidwbs",authDomain:"memorize-cb9a7.firebaseapp.com",projectId:"memorize-cb9a7",storageBucket:"memorize-cb9a7.appspot.com",messagingSenderId:"680712601487",appId:"1:680712601487:web:8e601113591735f05395fa",measurementId:"G-G8RP2C41BN"}),console.log("Firebase initialized successfully")}catch(e){console.error("Error initializing Firebase:",e)}let m=(0,n.ad)(a);(0,o.v0)(a),(0,d.IH)(a),async function(){try{let e=await (0,n.PL)((0,n.hJ)(m,"test_collection"));console.log("Firestore connection successful"),e.forEach(e=>{console.log("".concat(e.id," => ").concat(JSON.stringify(e.data())))})}catch(e){console.error("Error connecting to Firestore:",e)}}();let x="sets",h="studyHistory",u="sessionStates",f=async e=>{try{return(await (0,n.ET)((0,n.hJ)(m,x),{...e,createdAt:(0,n.Bt)(),updatedAt:(0,n.Bt)()})).id}catch(e){throw console.error("Error saving set:",e),e}},j=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{let s=(0,n.hJ)(m,x);return e&&(s=(0,n.IO)(s,(0,n.ar)("type","==",e))),s=(0,n.IO)(s,(0,n.Xo)("updatedAt","desc")),(await (0,n.PL)(s)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting sets:",e),e}},g=async()=>{try{let e=(0,n.IO)((0,n.hJ)(m,x),(0,n.Xo)("updatedAt","desc"));return(await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting all sets:",e),e}},p=async e=>{try{let s=(0,n.JU)(m,x,e),t=await (0,n.QT)(s);if(t.exists())return{id:t.id,...t.data()};throw Error("Set not found")}catch(e){throw console.error("Error getting set:",e),e}},b=async e=>{try{let s=(0,n.JU)(m,x,e.id);return await (0,n.r7)(s,{...e,updatedAt:(0,n.Bt)()}),e.id}catch(e){throw console.error("Error updating set:",e),e}},N=async e=>{try{await (0,n.oe)((0,n.JU)(m,x,e))}catch(e){throw console.error("Error deleting set:",e),e}},v=async(e,s,t,a,l,i)=>{try{let r={setId:e,setTitle:s,setType:t,score:a,date:new Date(l).toISOString(),studyDuration:i,createdAt:(0,n.Bt)()};return(await (0,n.ET)((0,n.hJ)(m,h),r)).id}catch(e){throw console.error("Error saving study history:",e),e}},y=async()=>{try{let e=(0,n.IO)((0,n.hJ)(m,h),(0,n.Xo)("createdAt","desc"));return(await (0,n.PL)(e)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){throw console.error("Error getting study history:",e),e}},w=async(e,s,t)=>{try{let a=(0,n.JU)(m,u,"".concat(e,"_").concat(s));await (0,n.pl)(a,{setId:e,setType:s,state:t,updatedAt:(0,n.Bt)()})}catch(e){throw console.error("Error saving session state:",e),e}},C=async(e,s)=>{try{let t=(0,n.JU)(m,u,"".concat(e,"_").concat(s)),a=await (0,n.QT)(t);if(a.exists())return a.data();return null}catch(e){throw console.error("Error getting session state:",e),e}},k=async(e,s)=>{try{await (0,n.oe)((0,n.JU)(m,u,"".concat(e,"_").concat(s)))}catch(e){throw console.error("Error clearing session state:",e),e}},S=async e=>{try{await (0,n.oe)((0,n.JU)(m,h,e))}catch(e){throw console.error("Error deleting study history entry:",e),e}};var z=t(4839),E=t(6164);function Z(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,E.m6)((0,z.W)(s))}let q=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});q.displayName="Card";let R=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:Z("flex flex-col space-y-1.5 p-6",t),...a})});R.displayName="CardHeader";let I=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("h3",{ref:s,className:Z("text-2xl font-semibold leading-none tracking-tight",t),...a})});I.displayName="CardTitle",r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("p",{ref:s,className:Z("text-sm text-muted-foreground",t),...a})}).displayName="CardDescription";let F=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:Z("p-6 pt-0",t),...a})});F.displayName="CardContent";let _=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:Z("flex items-center p-6 pt-0",t),...a})});_.displayName="CardFooter";var D=t(1538),T=t(2218);let A=(0,T.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),B=r.forwardRef((e,s)=>{let{className:t,variant:a,size:l,asChild:r=!1,...c}=e,n=r?D.g7:"button";return(0,i.jsx)(n,{className:Z(A({variant:a,size:l,className:t})),ref:s,...c})});B.displayName="Button";var M=t(6506);let O=r.forwardRef((e,s)=>{let{className:t,value:a,indicatorClassName:l,...r}=e;return(0,i.jsx)(M.fC,{ref:s,className:Z("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:(0,i.jsx)(M.z$,{className:Z("h-full w-full flex-1 bg-primary transition-all",l),style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});O.displayName=M.fC.displayName;var L=t(9385);let Q=L.fC,U=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(L.aV,{ref:s,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})});U.displayName=L.aV.displayName;let V=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(L.xz,{ref:s,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})});V.displayName=L.xz.displayName;let H=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(L.VY,{ref:s,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})});H.displayName=L.VY.displayName;var J=t(8948),P=t(4436),G=t(7746),X=t(4241),Y=t(4258),W=t(5016),$=t(7427),K=t(6273),ee=t(6540),es=t(933),et=t(3304),ea=t(4697);let el=et.fC;et.xz;let ei=et.h_;et.x8;let er=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(et.aV,{ref:s,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a})});er.displayName=et.aV.displayName;let ec=r.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,i.jsxs)(ei,{children:[(0,i.jsx)(er,{}),(0,i.jsxs)(et.VY,{ref:s,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...l,children:[a,(0,i.jsxs)(et.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,i.jsx)(ea.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});ec.displayName=et.VY.displayName;let en=e=>{let{className:s,...t}=e;return(0,i.jsx)("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};en.displayName="DialogHeader";let eo=e=>{let{className:s,...t}=e;return(0,i.jsx)("div",{className:Z("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};eo.displayName="DialogFooter";let ed=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(et.Dx,{ref:s,className:Z("text-lg font-semibold leading-none tracking-tight",t),...a})});ed.displayName=et.Dx.displayName;let em=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(et.dk,{ref:s,className:Z("text-sm text-muted-foreground",t),...a})});em.displayName=et.dk.displayName;let ex=r.forwardRef((e,s)=>{let{className:t,type:a,...l}=e;return(0,i.jsx)("input",{type:a,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});ex.displayName="Input";var eh=t(8364);let eu=(0,T.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ef=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eh.f,{ref:s,className:Z(eu(),t),...a})});ef.displayName=eh.f.displayName;var ej=t(883),eg=e=>{let{isOpen:s,onClose:t,onSave:a,onDelete:l,editingEvent:c}=e,[n,o]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),[x,h]=(0,r.useState)("");return(0,r.useEffect)(()=>{if(c){o(c.title);let e=new Date(c.date);m(e.toISOString().split("T")[0]),h(e.toTimeString().slice(0,5))}else o(""),m(""),h("")},[c]),(0,i.jsx)(el,{open:s,onOpenChange:t,children:(0,i.jsxs)(ec,{children:[(0,i.jsxs)(en,{children:[(0,i.jsx)(ed,{children:c?"予定を編集":"予定を追加"}),(0,i.jsx)(em,{children:c?"既存の予定を編集します。":"新しい予定を追加します。"})]}),(0,i.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,i.jsx)(ef,{htmlFor:"title",className:"text-right",children:"タイトル"}),(0,i.jsx)(ex,{id:"title",value:n,onChange:e=>o(e.target.value),className:"col-span-3"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,i.jsx)(ef,{htmlFor:"date",className:"text-right",children:"日付"}),(0,i.jsx)(ex,{id:"date",type:"date",value:d,onChange:e=>m(e.target.value),className:"col-span-3"})]}),(0,i.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,i.jsx)(ef,{htmlFor:"time",className:"text-right",children:"時間"}),(0,i.jsx)(ex,{id:"time",type:"time",value:x,onChange:e=>h(e.target.value),className:"col-span-3"})]})]}),(0,i.jsxs)(eo,{children:[c&&(0,i.jsxs)(B,{variant:"destructive",onClick:()=>{c&&(l(c.id),t())},children:[(0,i.jsx)(ej.Z,{className:"mr-2 h-4 w-4"}),"削除"]}),(0,i.jsx)(B,{onClick:()=>{let e=new Date("".concat(d,"T").concat(x));a({id:null==c?void 0:c.id,title:n,date:e}),t()},children:"保存"})]})]})})},ep=e=>{let{onCreateSet:s,onStartLearning:t,onShowStatistics:a,overallProgress:l,setOverallProgress:c,streak:n,setStreak:o,studyHistory:d,setStudyHistory:m,dailyGoal:x,setDailyGoal:h,todayStudyTime:u,setTodayStudyTime:f,onOpenSettings:j}=e,[p,b]=(0,r.useState)(!1),[N,v]=(0,r.useState)([]),[y,w]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[z,E]=(0,r.useState)([]),Z=(0,r.useCallback)(async()=>{try{await g()}catch(e){console.error("Error loading data:",e)}},[c,o]);(0,r.useEffect)(()=>{Z()},[Z]),(0,r.useEffect)(()=>{b(u>=x)},[u,x]);let _=(0,r.useCallback)(()=>{},[p,o]);(0,r.useEffect)(()=>{_()},[p,_]);let D=(0,r.useCallback)(e=>{switch(e){case"flashcard":default:return(0,i.jsx)(J.Z,{className:"mr-3 text-blue-500",size:24});case"qa":return(0,i.jsx)(P.Z,{className:"mr-3 text-green-500",size:24});case"multiple-choice":return(0,i.jsx)(G.Z,{className:"mr-3 text-purple-500",size:24});case"classification":return(0,i.jsx)(X.Z,{className:"mr-3 text-red-500",size:24})}},[]),T=(0,r.useCallback)(e=>{let s=new Date(e),t=new Date().getTime()-s.getTime(),a=Math.floor(t/6e4),l=Math.floor(t/36e5),i=Math.floor(t/864e5);return isNaN(s.getTime())?"日付不明":a<60?"".concat(a,"分前"):l<24?"".concat(l,"時間前"):0===i?"今日":1===i?"昨日":"".concat(i,"日前")},[]),A=(0,r.useCallback)(e=>new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),[]),M=(0,r.useCallback)(()=>{S(null),w(!0)},[]),L=(0,r.useCallback)(e=>{S(e),w(!0)},[]),et=(0,r.useCallback)(e=>{v(s=>e.id?s.map(s=>s.id===e.id?e:s):[...s,{...e,id:Date.now()}]),el(e)},[]),ea=(0,r.useCallback)(e=>{v(s=>s.filter(s=>s.id!==e))},[]),el=(0,r.useCallback)(e=>{let s=new Date,t=new Date(e.date).getTime()-s.getTime();t>0&&setTimeout(()=>{"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:"予定の時間です！"})},t)},[]);(0,r.useEffect)(()=>{"Notification"in window&&Notification.requestPermission()},[]);let ei=(0,r.useCallback)(async()=>{try{let e=await g(),s=(await Promise.all(e.map(async e=>{let s=await C(e.id,e.type);return s&&s.state?{...e,sessionState:s.state,timestamp:s.timestamp,type:e.type}:null}))).filter(Boolean).sort((e,s)=>new Date(s.timestamp)-new Date(e.timestamp)).slice(0,3);E(s)}catch(e){console.error("Error loading recent activities:",e)}},[]);(0,r.useEffect)(()=>{ei()},[ei]);let er=(0,r.useCallback)(e=>(0,i.jsxs)("li",{className:"flex items-center p-2 rounded-md hover:bg-gray-200 cursor-pointer transition-colors duration-200",onClick:()=>t(e.id,e.type,e.sessionState),children:[D(e.type),(0,i.jsxs)("div",{className:"flex-1 ml-2",children:[(0,i.jsx)("span",{className:"font-medium text-xs",children:e.title}),(0,i.jsx)("p",{className:"text-[10px] text-gray-500",children:T(e.timestamp)})]}),(0,i.jsx)("span",{className:"text-xs text-blue-500",children:"再開"})]},e.id),[t,D,T]);return(0,i.jsxs)("div",{className:"p-3 w-full max-w-[390px] mx-auto bg-gray-100",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,i.jsx)("h1",{className:"text-lg font-bold text-gray-800",children:"暗記アプリ"}),(0,i.jsx)(B,{variant:"ghost",size:"sm",onClick:j,children:(0,i.jsx)(Y.Z,{className:"text-gray-600 h-5 w-5"})})]}),(0,i.jsx)(q,{className:"mb-3 bg-gray-800 text-white",children:(0,i.jsxs)(F,{className:"py-2 px-3",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(W.Z,{className:"mr-1 text-gray-300",size:16}),(0,i.jsxs)("span",{className:"font-bold text-xs",children:["継続: ",n,"日"]})]}),(0,i.jsxs)(B,{variant:"outline",size:"xs",onClick:a,className:"text-xs px-2 py-1 text-gray-800 bg-gray-200 hover:bg-gray-300",children:[(0,i.jsx)($.Z,{className:"mr-1 h-3 w-3"}),"詳細"]})]}),(0,i.jsx)("p",{className:"mb-1 text-xs",children:"全体の進捗"}),(0,i.jsx)(O,{value:l,className:"w-full h-2 bg-gray-600",indicatorClassName:"bg-white"}),(0,i.jsxs)("p",{className:"text-center mt-1 text-xs",children:[l.toFixed(1),"%"]})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,i.jsxs)(B,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:s,children:[(0,i.jsx)(K.Z,{className:"mr-1 h-3 w-3"}),"作成/編集"]}),(0,i.jsxs)(B,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:t,children:[(0,i.jsx)(ee.Z,{className:"mr-1 h-3 w-3"}),"学習開始"]})]}),(0,i.jsxs)(Q,{defaultValue:"recent",className:"mb-3",children:[(0,i.jsxs)(U,{className:"grid w-full grid-cols-2",children:[(0,i.jsx)(V,{value:"recent",className:"text-xs",children:"最近の学習"}),(0,i.jsx)(V,{value:"scheduled",className:"text-xs",children:"予定"})]}),(0,i.jsx)(H,{value:"recent",children:(0,i.jsx)(q,{children:(0,i.jsx)(F,{className:"py-2 px-3",children:z.length>0?(0,i.jsx)("ul",{className:"space-y-2",children:z.map(er)}):(0,i.jsx)("p",{className:"text-center text-gray-500",children:"未完了のセッションはありません"})})})}),(0,i.jsx)(H,{value:"scheduled",children:(0,i.jsx)(q,{children:(0,i.jsxs)(F,{className:"py-2 px-3",children:[(0,i.jsx)("ul",{className:"space-y-2",children:N.map(e=>(0,i.jsxs)("li",{className:"flex items-center",children:[(0,i.jsx)(X.Z,{className:"mr-3 text-blue-500",size:24}),(0,i.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>L(e),children:[(0,i.jsx)("span",{className:"font-medium text-xs",children:e.title}),(0,i.jsx)("p",{className:"text-[10px] text-gray-500",children:A(e.date)})]})]},e.id))}),(0,i.jsxs)(B,{className:"w-full mt-4",onClick:M,children:[(0,i.jsx)(K.Z,{className:"mr-2 h-4 w-4"}),"予定を追加"]})]})})})]}),(0,i.jsxs)(q,{children:[(0,i.jsx)(R,{className:"py-2 px-3",children:(0,i.jsxs)(I,{className:"flex items-center text-sm",children:[(0,i.jsx)(es.Z,{className:"mr-2 text-gray-600",size:16}),"今日の目標"]})}),(0,i.jsxs)(F,{className:"py-2 px-3",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,i.jsxs)("span",{className:"text-xs",children:[u,"分 / ",x,"分"]}),(0,i.jsx)(O,{value:u/x*100,className:"w-1/2 h-2"})]}),p&&(0,i.jsx)("p",{className:"text-gray-700 font-bold text-xs",children:"目標達成！"})]})]}),(0,i.jsx)(eg,{isOpen:y,onClose:()=>w(!1),onSave:et,onDelete:ea,editingEvent:k})]})},eb=t(5574),eN=t(374),ev=t(5931),ey=t(1266),ew=t(2513),eC=t(6649),ek=e=>{let{onBack:s,onSelectType:t,onEditType:a}=e,l=[{id:"flashcard",title:"フラッシュカード",icon:ee.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:eb.Z,description:"質問と回答のペアを作成"},{id:"multiple-choice",title:"多肢選択",icon:eN.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:ev.Z,description:"項目をカテゴリーに分類"}];return(0,i.jsxs)("div",{className:"p-4 w-full",children:[(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,className:"mr-2 p-1",children:(0,i.jsx)(ey.Z,{className:"h-5 w-5"})}),(0,i.jsx)("h1",{className:"text-lg font-bold",children:"セットの作成・編集"})]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"学習セットのタイプを選択:"}),(0,i.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,i.jsxs)(q,{className:"hover:shadow-md transition-shadow",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center space-y-0 py-3 px-4",children:[(0,i.jsx)(e.icon,{className:"h-6 w-6 text-primary mr-3 flex-shrink-0"}),(0,i.jsx)(I,{className:"text-base font-medium",children:e.title})]}),(0,i.jsxs)(F,{className:"py-2 px-4",children:[(0,i.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:e.description}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(B,{size:"sm",className:"flex-1 text-xs",onClick:()=>t(e.id),children:[(0,i.jsx)(ew.Z,{className:"mr-1 h-3 w-3"})," 新規作成"]}),(0,i.jsxs)(B,{size:"sm",variant:"outline",className:"flex-1 text-xs",onClick:()=>a(e.id),children:[(0,i.jsx)(eC.Z,{className:"mr-1 h-3 w-3"})," 編集"]})]})]})]},e.id))})]})},eS=t(1543),ez=t(2421),eE=t(4392),eZ=t(2468);let eq=eS.fC;eS.ZA;let eR=eS.B4,eI=r.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,i.jsxs)(eS.xz,{ref:s,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...l,children:[a,(0,i.jsx)(eS.JO,{asChild:!0,children:(0,i.jsx)(ez.Z,{className:"h-4 w-4 opacity-50"})})]})});eI.displayName=eS.xz.displayName;let eF=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eS.u_,{ref:s,className:Z("flex cursor-default items-center justify-center py-1",t),...a,children:(0,i.jsx)(eE.Z,{className:"h-4 w-4"})})});eF.displayName=eS.u_.displayName;let e_=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eS.$G,{ref:s,className:Z("flex cursor-default items-center justify-center py-1",t),...a,children:(0,i.jsx)(ez.Z,{className:"h-4 w-4"})})});e_.displayName=eS.$G.displayName;let eD=r.forwardRef((e,s)=>{let{className:t,children:a,position:l="popper",...r}=e;return(0,i.jsx)(eS.h_,{children:(0,i.jsxs)(eS.VY,{ref:s,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...r,children:[(0,i.jsx)(eF,{}),(0,i.jsx)(eS.l_,{className:Z("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,i.jsx)(e_,{})]})})});eD.displayName=eS.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eS.__,{ref:s,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})}).displayName=eS.__.displayName;let eT=r.forwardRef((e,s)=>{let{className:t,children:a,...l}=e;return(0,i.jsxs)(eS.ck,{ref:s,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(eS.wU,{children:(0,i.jsx)(eZ.Z,{className:"h-4 w-4"})})}),(0,i.jsx)(eS.eT,{children:a})]})});eT.displayName=eS.ck.displayName,r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eS.Z0,{ref:s,className:Z("-mx-1 my-1 h-px bg-muted",t),...a})}).displayName=eS.Z0.displayName;var eA=t(8094),eB=e=>{let{onBack:s,onStartQuiz:t}=e,[a,l]=(0,r.useState)({flashcard:[],qa:[],"multiple-choice":[],classification:[]}),[c,n]=(0,r.useState)({flashcard:"",qa:"","multiple-choice":"",classification:""});(0,r.useEffect)(()=>{(async()=>{try{let[e,s,t,a]=await Promise.all([j("flashcard"),j("qa"),j("multiple-choice"),j("classification")]);l({flashcard:e,qa:s,"multiple-choice":t,classification:a})}catch(e){console.error("Error loading sets:",e)}})()},[]);let o=[{id:"flashcard",title:"フラッシュカード",icon:ee.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:eb.Z,description:"質問と回答のペアで学習"},{id:"multiple-choice",title:"多肢選択",icon:eN.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:ev.Z,description:"項目をカテゴリーに分類"}],d=(0,r.useCallback)((e,s)=>{n(t=>({...t,[e]:s}))},[]),m=(0,r.useCallback)(async e=>{var s,l,i;let r=c[e]||(null===(i=a[e])||void 0===i?void 0:null===(l=i[0])||void 0===l?void 0:null===(s=l.id)||void 0===s?void 0:s.toString());r&&(await k(parseInt(r,10),e),t(e,parseInt(r,10)))},[c,a,t]);return(0,i.jsxs)("div",{className:"p-4 w-full",children:[(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,className:"mr-2 p-1",children:(0,i.jsx)(ey.Z,{className:"h-5 w-5"})}),(0,i.jsx)("h1",{className:"text-lg font-bold",children:"学習タイプを選択"})]}),(0,i.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"クイズタイプとセットを選択:"}),(0,i.jsx)("div",{className:"space-y-3",children:o.map(e=>{var s,t,l,r;return(0,i.jsxs)(q,{className:"hover:shadow-md transition-shadow",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center space-y-0 py-3 px-4",children:[(0,i.jsx)(e.icon,{className:"h-6 w-6 text-primary mr-3 flex-shrink-0"}),(0,i.jsx)(I,{className:"text-base font-medium",children:e.title})]}),(0,i.jsxs)(F,{className:"py-2 px-4",children:[(0,i.jsx)("p",{className:"text-xs text-gray-500 mb-3",children:e.description}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsxs)(eq,{onValueChange:s=>d(e.id,s),value:c[e.id]||(null===(l=a[e.id])||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:null===(s=t.id)||void 0===s?void 0:s.toString())||"",children:[(0,i.jsx)(eI,{className:"text-xs flex-grow",children:(0,i.jsx)(eR,{placeholder:"セットを選択"})}),(0,i.jsx)(eD,{children:null===(r=a[e.id])||void 0===r?void 0:r.map(e=>(0,i.jsx)(eT,{value:e.id.toString(),children:e.title},e.id))})]}),(0,i.jsxs)(B,{size:"sm",className:"text-xs whitespace-nowrap",onClick:()=>m(e.id),children:[(0,i.jsx)(eA.Z,{className:"mr-1 h-3 w-3"})," 学習開始"]})]})]})]},e.id)})})]})};let eM=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("textarea",{className:Z("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a})});eM.displayName="Textarea";let eO=(0,T.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eL=r.forwardRef((e,s)=>{let{className:t,variant:a,...l}=e;return(0,i.jsx)("div",{ref:s,role:"alert",className:Z(eO({variant:a}),t),...l})});eL.displayName="Alert",r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("h5",{ref:s,className:Z("mb-1 font-medium leading-none tracking-tight",t),...a})}).displayName="AlertTitle";let eQ=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)("div",{ref:s,className:Z("text-sm [&_p]:leading-relaxed",t),...a})});eQ.displayName="AlertDescription";var eU=t(7019),eV=t(5733),eH=t(9061);function eJ(){let e=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let s=e.current;if(!s)return;let t=()=>{setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"center"})},100)};return s.addEventListener("focus",t),()=>{s.removeEventListener("focus",t)}},[]),e}var eP=t(2107);let eG=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let t={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0,...s};console.log("圧縮前のファイルサイズ:",e.size/1024/1024,"MB");let a=await (0,eP.Z)(e,t);return console.log("圧縮後のファイルサイズ:",a.size/1024/1024,"MB"),a}catch(e){throw console.error("画像圧縮中にエラーが発生しました:",e),e}};var eX=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)(""),[c,n]=(0,r.useState)([{front:"",back:"",image:null}]),[o,d]=(0,r.useState)({}),[m,x]=(0,r.useState)(null),h=eJ(),u=(0,r.useCallback)(()=>{n(e=>[...e,{front:"",back:"",image:null}])},[]),j=(0,r.useCallback)((e,s,t)=>{n(a=>a.map((a,l)=>l===e?{...a,[s]:t}:a))},[]),g=(0,r.useCallback)(e=>{n(s=>s.filter((s,t)=>t!==e))},[]),p=(0,r.useCallback)(async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{j(e,"image",a.result)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),d(e=>({...e,image:"画像の圧縮中にエラーが発生しました。"}))}},[j]),b=(0,r.useCallback)(()=>{let e={};return a.trim()||(e.title="セットタイトルを入力してください。"),c.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),d(e),0===Object.keys(e).length},[a,c]),N=(0,r.useCallback)(async()=>{if(b())try{let e={title:a,cards:c,type:"flashcard"},s=await f(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e),d(e=>({...e,save:"セットの保存中にエラーが発生しました。"}))}},[a,c,b,t]),v=(0,r.useCallback)(e=>{x(s=>s===e?null:e)},[]);return(0,i.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード作成"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)(ex,{ref:h,placeholder:"セットのタイトル",value:a,onChange:e=>l(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o.title})})]}),c.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>v(s),children:m===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>g(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:m===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,i.jsx)("p",{children:e.front}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Card front",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,i.jsx)("p",{children:e.back})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{ref:h,placeholder:"表面",value:e.front,onChange:e=>j(s,"front",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(eM,{ref:h,placeholder:"裏面",value:e.back,onChange:e=>j(s,"back",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(ex,{ref:h,type:"file",accept:"image/*",onChange:e=>p(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,i.jsx)(_,{children:o["card".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["card".concat(s)]})})})]},s))]}),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:u,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,i.jsxs)(B,{onClick:N,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eY=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)([]),[c,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[m,x]=(0,r.useState)([]),[h,u]=(0,r.useState)({}),[f,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await j("flashcard");l(e)}catch(e){console.error("Error loading sets:",e),u({...h,load:"セットの読み込み中にエラーが発生しました。"})}})()},[]);let v=async e=>{n(e);try{let s=await p(e);d(s.title),Array.isArray(s.cards)&&s.cards.length>0?x(s.cards):x([])}catch(e){console.error("Error loading set:",e),u({...h,load:"セットの読み込み中にエラーが発生しました。"}),x([])}},y=(e,s,t)=>{x(m.map((a,l)=>l===e?{...a,[s]:t}:a))},w=e=>{x(m.filter((s,t)=>t!==e))},C=async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{y(e,"image",a.result)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),u({...h,image:"画像の圧縮中にエラーが発生しました。"})}},k=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),m.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),u(e),0===Object.keys(e).length},S=async()=>{if(k())try{let e={id:c,title:o,cards:m,type:"flashcard"};await b(e),t(e)}catch(e){console.error("Error updating set:",e),u({...h,save:"セットの更新中にエラーが発生しました。"})}},z=e=>{g(f===e?null:e)},E=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await N(c),s()}catch(e){console.error("Error deleting set:",e),u({...h,delete:"セットの削除中にエラーが発生しました。"})}};return(0,i.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード編集"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)(eq,{onValueChange:v,value:c,children:[(0,i.jsx)(eI,{className:"w-full",children:(0,i.jsx)(eR,{placeholder:"編集するセットを選択"})}),(0,i.jsx)(eD,{children:a.map(e=>(0,i.jsx)(eT,{value:e.id.toString(),children:e.title},e.id))})]}),(0,i.jsx)(ex,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),h.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h.title})}),c&&(0,i.jsxs)(B,{onClick:E,variant:"destructive",className:"mt-2",children:[(0,i.jsx)(ej.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),m&&m.length>0?m.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>z(s),children:f===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>w(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:f===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,i.jsx)("p",{children:e.front}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Card image",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,i.jsx)("p",{children:e.back})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{placeholder:"表面",value:e.front,onChange:e=>y(s,"front",e.target.value),className:"mb-2"}),(0,i.jsx)(ex,{type:"file",accept:"image/*",onChange:e=>C(s,e),className:"mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded image",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)(eM,{placeholder:"裏面",value:e.back,onChange:e=>y(s,"back",e.target.value),className:"mt-4 mb-2"})]})}),(0,i.jsx)(_,{children:h["card".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["card".concat(s)]})})})]},s)):(0,i.jsx)("p",{children:c?"このセットにはカードがありません。新しいカードを追加してください。":"セットを選択するか、新しいカードを追加してください。"}),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:()=>{x([...m,{front:"",back:"",image:null}])},children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,i.jsxs)(B,{onClick:S,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eW=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)(""),[c,n]=(0,r.useState)([{question:"",answer:"",image:null}]),[o,d]=(0,r.useState)({}),[m,x]=(0,r.useState)(null),h=eJ(),u=(0,r.useCallback)(()=>{n(e=>[...e,{question:"",answer:"",image:null}])},[]),j=(0,r.useCallback)((e,s,t)=>{n(a=>a.map((a,l)=>l===e?{...a,[s]:t}:a))},[]),g=(0,r.useCallback)(e=>{n(s=>s.filter((s,t)=>t!==e))},[]),p=(0,r.useCallback)(async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{j(e,"image",a.result)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),d(e=>({...e,image:"画像の圧縮中にエラーが発生しました。"}))}},[j]),b=(0,r.useCallback)(()=>{let e={};return a.trim()||(e.title="セットタイトルを入力してください。"),c.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),d(e),0===Object.keys(e).length},[a,c]),N=(0,r.useCallback)(async()=>{if(b())try{let e={title:a,qaItems:c,type:"qa"},s=await f(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e),d(e=>({...e,save:"セットの保存中にエラーが発生しました。"}))}},[a,c,b,t]),v=(0,r.useCallback)(e=>{x(s=>s===e?null:e)},[]);return(0,i.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答作成"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)(ex,{ref:h,placeholder:"セットのタイトル",value:a,onChange:e=>l(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o.title})})]}),c.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>v(s),children:m===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>g(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:m===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,i.jsx)("p",{children:e.question}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,i.jsx)("p",{children:e.answer})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{ref:h,placeholder:"質問",value:e.question,onChange:e=>j(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(eM,{ref:h,placeholder:"回答",value:e.answer,onChange:e=>j(s,"answer",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(ex,{ref:h,type:"file",accept:"image/*",onChange:e=>p(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,i.jsx)(_,{children:o["item".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["item".concat(s)]})})})]},s))]}),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:u,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,i.jsxs)(B,{onClick:N,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},e$=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)([]),[c,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[m,x]=(0,r.useState)([{question:"",answer:"",image:null}]),[h,u]=(0,r.useState)({}),[f,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await j("qa");l(e)}catch(e){console.error("Error loading sets:",e),u(e=>({...e,load:"セットの読み込み中にエラーが発生しました。"}))}})()},[]);let v=(0,r.useCallback)(async e=>{n(e);try{let s=await p(parseInt(e));d(s.title),x(s.qaItems)}catch(e){console.error("Error loading set:",e),u(e=>({...e,load:"セットの読み込み中にエラーが発生しました。"}))}},[]),y=(0,r.useCallback)(()=>{x(e=>[...e,{question:"",answer:"",image:null}])},[]),w=(0,r.useCallback)((e,s,t)=>{x(a=>a.map((a,l)=>l===e?{...a,[s]:t}:a))},[]),C=(0,r.useCallback)(e=>{x(s=>s.filter((s,t)=>t!==e))},[]),k=(0,r.useCallback)(async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{w(e,"image",a.result)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),u(e=>({...e,image:"画像の圧縮中にエラーが発生しました。"}))}},[w]),S=(0,r.useCallback)(()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),m.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),u(e),0===Object.keys(e).length},[o,m]),z=(0,r.useCallback)(async()=>{if(S())try{let e={id:parseInt(c),title:o,qaItems:m,type:"qa"};await b(e),t(e)}catch(e){console.error("Error updating set:",e),u(e=>({...e,save:"セットの更新中にエラーが発生しました。"}))}},[c,o,m,S,t]),E=(0,r.useCallback)(async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await N(parseInt(c)),s()}catch(e){console.error("Error deleting set:",e),u(e=>({...e,delete:"セットの削除中にエラーが発生しました。"}))}},[c,s]);return(0,i.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答編集"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)(eq,{onValueChange:v,value:c,children:[(0,i.jsx)(eI,{className:"w-full",children:(0,i.jsx)(eR,{placeholder:"編集するセットを選択"})}),(0,i.jsx)(eD,{children:a.map(e=>(0,i.jsx)(eT,{value:e.id.toString(),children:e.title},e.id))})]}),(0,i.jsx)(ex,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),h.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h.title})}),c&&(0,i.jsxs)(B,{onClick:E,variant:"destructive",className:"mt-2",children:[(0,i.jsx)(ej.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),m.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>g(f===s?null:s),children:f===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>C(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:f===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,i.jsx)("p",{children:e.question}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,i.jsx)("p",{children:e.answer})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{placeholder:"質問",value:e.question,onChange:e=>w(s,"question",e.target.value),className:"mb-2"}),(0,i.jsx)(eM,{placeholder:"回答",value:e.answer,onChange:e=>w(s,"answer",e.target.value),className:"mb-2"}),(0,i.jsx)(ex,{type:"file",accept:"image/*",onChange:e=>k(s,e),className:"mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,i.jsx)(_,{children:h["item".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["item".concat(s)]})})})]},s)),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:y,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,i.jsxs)(B,{onClick:z,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eK=t(9324);let e0=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(eK.fC,{ref:s,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,i.jsx)(eK.z$,{className:Z("flex items-center justify-center text-current"),children:(0,i.jsx)(eZ.Z,{className:"h-4 w-4"})})})});e0.displayName=eK.fC.displayName;var e2=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)(""),[c,n]=(0,r.useState)([{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}]),[o,d]=(0,r.useState)({}),[m,x]=(0,r.useState)(null),h=eJ(),u=(0,r.useCallback)(()=>{n(e=>[...e,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},[]),j=(0,r.useCallback)((e,s,t)=>{n(a=>a.map((a,l)=>l===e?{...a,[s]:t}:a))},[]),g=(0,r.useCallback)(e=>{n(s=>s.filter((s,t)=>t!==e))},[]),p=(0,r.useCallback)(e=>{n(s=>s.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},[]),b=(0,r.useCallback)((e,s,t,a)=>{n(l=>l.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},[]),N=(0,r.useCallback)((e,s)=>{n(t=>t.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},[]),v=(0,r.useCallback)(async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{j(e,"image",a.result)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),d(e=>({...e,image:"画像の圧縮中にエラーが発生しました。"}))}},[j]),y=(0,r.useCallback)(()=>{let e={};return a.trim()||(e.title="セットタイトルを入力してください。"),c.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),d(e),0===Object.keys(e).length},[a,c]),w=(0,r.useCallback)(async()=>{if(y())try{let e={title:a,questions:c,type:"multiple-choice"},s=await f(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e),d(e=>({...e,save:"セットの保存中にエラーが発生しました。"}))}},[a,c,y,t]),C=(0,r.useCallback)(e=>{x(s=>s===e?null:e)},[]);return(0,i.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題作成"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)(ex,{placeholder:"セットのタイトル",value:a,onChange:e=>l(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o.title})})]}),c.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>C(s),children:m===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>g(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:m===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,i.jsx)("p",{children:e.question}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,i.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,i.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{ref:h,placeholder:"問題文",value:e.question,onChange:e=>j(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(ex,{ref:h,type:"file",accept:"image/*",onChange:e=>v(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)(e0,{ref:h,checked:e.isCorrect,onCheckedChange:e=>b(s,t,"isCorrect",e),className:"mr-2"}),(0,i.jsx)(ex,{ref:h,placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>b(s,t,"text",e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>N(s,t),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]},t)),(0,i.jsxs)(B,{onClick:()=>p(s),children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,i.jsxs)(_,{children:[o["question".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["question".concat(s)]})}),o["question".concat(s,"choices")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["question".concat(s,"choices")]})}),o["question".concat(s,"correct")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["question".concat(s,"correct")]})})]})]},s)),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:u,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,i.jsxs)(B,{onClick:w,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},e4=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)([]),[c,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[m,x]=(0,r.useState)([]),[h,u]=(0,r.useState)({}),[f,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{let e=await j("multiple-choice");l(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let v=async e=>{n(e);try{let s=await p(parseInt(e));d(s.title),x(s.questions)}catch(e){console.error("Error loading set:",e)}},y=(e,s,t)=>{x(m.map((a,l)=>l===e?{...a,[s]:t}:a))},w=e=>{x(m.filter((s,t)=>t!==e))},C=e=>{x(m.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},k=(e,s,t,a)=>{x(m.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},S=(e,s)=>{x(m.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},z=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{y(e,"image",s.result)},s.readAsDataURL(t)}},E=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),m.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),u(e),0===Object.keys(e).length},Z=async()=>{if(E())try{let e={id:parseInt(c),title:o,questions:m,type:"multiple-choice"};await b(e),t(e)}catch(e){console.error("Error updating set:",e)}},D=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await N(parseInt(c)),s()}catch(e){console.error("Error deleting set:",e)}};return(0,i.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題編集"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)(eq,{onValueChange:v,value:c,children:[(0,i.jsx)(eI,{className:"w-full",children:(0,i.jsx)(eR,{placeholder:"編集するセットを選択"})}),(0,i.jsx)(eD,{children:a.map(e=>(0,i.jsx)(eT,{value:e.id.toString(),children:e.title},e.id))})]}),(0,i.jsx)(ex,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),h.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h.title})}),c&&(0,i.jsxs)(B,{onClick:D,variant:"destructive",className:"mt-2",children:[(0,i.jsx)(ej.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),m.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>g(f===s?null:s),children:f===s?(0,i.jsx)(eU.Z,{className:"h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"h-4 w-4"})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>w(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsx)(F,{children:f===s?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,i.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,i.jsx)("p",{children:e.question}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,i.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,i.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eM,{placeholder:"問題文",value:e.question,onChange:e=>y(s,"question",e.target.value),className:"mb-2"}),(0,i.jsx)(ex,{type:"file",accept:"image/*",onChange:e=>z(s,e),className:"mb-2"}),e.image&&(0,i.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,i.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center mb-2",children:[(0,i.jsx)(e0,{checked:e.isCorrect,onCheckedChange:e=>k(s,t,"isCorrect",e),className:"mr-2"}),(0,i.jsx)(ex,{placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>k(s,t,"text",e.target.value),className:"flex-grow mr-2"}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>S(s,t),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]},t)),(0,i.jsxs)(B,{onClick:()=>C(s),className:"mt-2",children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,i.jsxs)(_,{children:[h["question".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["question".concat(s)]})}),h["question".concat(s,"choices")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["question".concat(s,"choices")]})}),h["question".concat(s,"correct")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["question".concat(s,"correct")]})})]})]},s)),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:()=>{x([...m,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,i.jsxs)(B,{onClick:Z,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},e1=t(8184),e3=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)(""),[c,n]=(0,r.useState)([{name:"",items:[""]}]),[o,d]=(0,r.useState)({}),[m,x]=(0,r.useState)(!1),[h,u]=(0,r.useState)(Array(10).fill(null)),j=eJ(),g=(e,s,t)=>{n(c.map((a,l)=>l===e?{...a,[s]:t}:a))},p=e=>{n(c.filter((s,t)=>t!==e))},b=e=>{n(c.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},N=(e,s,t)=>{n(c.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},v=(e,s)=>{n(c.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},y=async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{let s=[...h];s[e]=a.result,u(s)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e)}},w=()=>{let e={};return a.trim()||(e.title="セットタイトルを入力してください。"),c.forEach((s,t)=>{s.name.trim()||h[t]||(e["category".concat(t)]="カテゴリー名または画像を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),d(e),0===Object.keys(e).length},C=async()=>{if(w())try{let e={title:a,categories:c.map((e,s)=>({...e,image:h[s]})),type:"classification"},s=await f(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e),d({...o,save:"セットの保存中にエラーが発生しました。"})}};return(0,i.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題作成"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)(ex,{ref:j,placeholder:"セットのタイトル",value:a,onChange:e=>l(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o.title})})]}),(0,i.jsxs)(B,{onClick:()=>x(!m),children:[m?(0,i.jsx)(eU.Z,{className:"mr-2 h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"mr-2 h-4 w-4"}),m?"プレビューを終了":"プレビュー"]}),m?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:a}),c.map((e,s)=>(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"font-bold",children:e.name}),(0,i.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,i.jsx)("li",{children:e},s))})]},s))]}):c.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsxs)("label",{htmlFor:"image-upload-".concat(s),className:"cursor-pointer mr-2",children:[(0,i.jsx)(e1.Z,{className:"h-4 w-4"}),(0,i.jsx)("input",{id:"image-upload-".concat(s),type:"file",accept:"image/*",className:"hidden",onChange:e=>y(s,e)})]}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>p(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsxs)(F,{children:[h[s]&&(0,i.jsx)("img",{src:h[s],alt:"Category",className:"w-full h-32 object-cover mb-2"}),(0,i.jsx)(ex,{ref:j,placeholder:"カテゴリー名",value:e.name,onChange:e=>g(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,i.jsxs)("div",{className:"flex mb-2",children:[(0,i.jsx)(ex,{ref:j,placeholder:"項目 ".concat(t+1),value:e,onChange:e=>N(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>v(s,t),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]},t)),(0,i.jsxs)(B,{onClick:()=>b(s),children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,i.jsxs)(_,{children:[o["category".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["category".concat(s)]})}),o["category".concat(s,"items")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:o["category".concat(s,"items")]})})]})]},s))]}),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:()=>{c.length<10&&n([...c,{name:"",items:[""]}])},disabled:c.length>=10,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,i.jsxs)(B,{onClick:C,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},e6=e=>{let{onBack:s,onSave:t}=e,[a,l]=(0,r.useState)([]),[c,n]=(0,r.useState)(""),[o,d]=(0,r.useState)(""),[m,x]=(0,r.useState)([{name:"",items:[""]}]),[h,u]=(0,r.useState)({}),[f,g]=(0,r.useState)(!1),[v,y]=(0,r.useState)(Array(10).fill(null));(0,r.useEffect)(()=>{(async()=>{try{let e=await j("classification");l(e)}catch(e){console.error("Error loading sets:",e),u({...h,load:"セットの読み込み中にエラーが発生しました。"})}})()},[]);let w=async e=>{n(e);try{let s=await p(e);d(s.title),x(s.categories||[{name:"",items:[""]}]),y(s.categoryImages||Array(10).fill(null))}catch(e){console.error("Error loading set:",e),u({...h,load:"セットの読み込み中にエラーが発生しました。"})}},C=async(e,s)=>{let t=s.target.files[0];if(t)try{let s=await eG(t),a=new FileReader;a.onloadend=()=>{let s=[...v];s[e]=a.result,y(s)},a.readAsDataURL(s)}catch(e){console.error("Error compressing image:",e),u({...h,image:"画像の圧縮中にエラーが発生しました。"})}},k=(e,s,t)=>{x(m.map((a,l)=>l===e?{...a,[s]:t}:a))},S=e=>{x(m.filter((s,t)=>t!==e))},z=e=>{x(m.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},E=(e,s,t)=>{x(m.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},Z=(e,s)=>{x(m.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},D=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),m.forEach((s,t)=>{s.name.trim()||v[t]||(e["category".concat(t)]="カテゴリー名または画像を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),u(e),0===Object.keys(e).length},T=async()=>{if(D())try{let e={id:c,title:o,categories:m,categoryImages:v,type:"classification"};await b(e),t(e)}catch(e){console.error("Error updating set:",e),u({...h,save:"セットの更新中にエラーが発生しました。"})}},A=async()=>{if(window.confirm("このセットを削除してもよろしいですか？この操作は取り消せません。"))try{await N(c),s()}catch(e){console.error("Error deleting set:",e),u({...h,delete:"セットの削除中にエラーが発生しました。"})}};return(0,i.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,i.jsxs)("div",{className:"scrollable-content px-4",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題編集"})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsxs)(eq,{onValueChange:w,value:c,children:[(0,i.jsx)(eI,{className:"w-full",children:(0,i.jsx)(eR,{placeholder:"編集するセットを選択"})}),(0,i.jsx)(eD,{children:a.map(e=>(0,i.jsx)(eT,{value:e.id.toString(),children:e.title},e.id))})]}),(0,i.jsx)(ex,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),h.title&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h.title})}),c&&(0,i.jsxs)(B,{onClick:A,variant:"destructive",className:"mt-2",children:[(0,i.jsx)(ej.Z,{className:"mr-2 h-4 w-4"})," セットを削除"]})]}),(0,i.jsxs)(B,{onClick:()=>g(!f),className:"mb-4",children:[f?(0,i.jsx)(eU.Z,{className:"mr-2 h-4 w-4"}):(0,i.jsx)(eV.Z,{className:"mr-2 h-4 w-4"}),f?"プレビューを終了":"プレビュー"]}),f?(0,i.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,i.jsx)("h2",{className:"text-xl font-bold mb-4",children:o}),m.map((e,s)=>(0,i.jsxs)("div",{className:"mb-4",children:[(0,i.jsx)("h3",{className:"font-bold",children:e.name}),(0,i.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,i.jsx)("li",{children:e},s))})]},s))]}):m.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsxs)(R,{className:"flex flex-row items-center justify-between pb-2",children:[(0,i.jsxs)(I,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsxs)("label",{htmlFor:"image-upload-".concat(s),className:"cursor-pointer mr-2",children:[(0,i.jsx)(e1.Z,{className:"h-4 w-4"}),(0,i.jsx)("input",{id:"image-upload-".concat(s),type:"file",accept:"image/*",className:"hidden",onChange:e=>C(s,e)})]}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>S(s),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]})]}),(0,i.jsxs)(F,{children:[v[s]&&(0,i.jsx)("img",{src:v[s],alt:"Category",className:"w-full h-32 object-cover mb-2"}),(0,i.jsx)(ex,{placeholder:"カテゴリー名",value:e.name,onChange:e=>k(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,i.jsxs)("div",{className:"flex mb-2",children:[(0,i.jsx)(ex,{placeholder:"項目 ".concat(t+1),value:e,onChange:e=>E(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>Z(s,t),children:(0,i.jsx)(ej.Z,{className:"h-4 w-4"})})]},t)),(0,i.jsxs)(B,{onClick:()=>z(s),children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,i.jsxs)(_,{children:[h["category".concat(s)]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["category".concat(s)]})}),h["category".concat(s,"items")]&&(0,i.jsx)(eL,{variant:"destructive",children:(0,i.jsx)(eQ,{children:h["category".concat(s,"items")]})})]})]},s)),(0,i.jsx)("div",{className:"fixed-bottom",children:(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)(B,{onClick:()=>{m.length<10&&x([...m,{name:"",items:[""]}])},disabled:m.length>=10,children:[(0,i.jsx)(ew.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,i.jsxs)(B,{onClick:T,children:[(0,i.jsx)(eH.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},e5=t(3522),e9=t(1976),e7=t(6753),e8=t(7662),se=t.n(e8);let ss=e=>{let{content:s,image:t,isFront:a}=e;return(0,i.jsxs)("div",{className:"".concat(se().flashcardContent," ").concat(a?se().frontContent:se().backContent),children:[(0,i.jsx)("p",{className:se().contentText,children:s}),t&&a&&(0,i.jsx)("div",{className:se().imageContainer,children:(0,i.jsx)("img",{src:t,alt:"Flashcard image",className:se().contentImage})})]})};var st=e=>{let{onFinish:s,onBack:t,setId:a,title:l,quizType:c,sessionState:n}=e,[o,d]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[h,u]=(0,r.useState)(0),[f,g]=(0,r.useState)(!1),[b,N]=(0,r.useState)([]),[y,C]=(0,r.useState)(!0),[k,S]=(0,r.useState)(null),z=(0,r.useRef)(new Date),E=(0,r.useCallback)(()=>{let e=m.length;return Math.round(b.filter(Boolean).length/e*100)},[m.length,b]),Z=(0,r.useCallback)(e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},[]);(0,r.useEffect)(()=>{(async()=>{try{C(!0);let e=[];if(e=null===a?(await j("flashcard")).flatMap(e=>e.cards):(await p(a)).cards,Array.isArray(e))d(e),n?(x(n.shuffledCards),u(n.currentCardIndex),N(n.completed)):(x(Z([...e])),N(Array(e.length).fill(!1)));else throw Error("Invalid data structure")}catch(e){console.error("Error loading flashcards:",e),S("フラッシュカードの読み込み中にエラーが発生しました。")}finally{C(!1)}})()},[a,n,Z]),(0,r.useEffect)(()=>{(async()=>{a&&await w(a,"flashcard",{shuffledCards:m,currentCardIndex:h,completed:b})})()},[a,m,h,b]);let q=(0,r.useCallback)(()=>{x(e=>Z([...e])),u(0),g(!1),N(e=>Array(e.length).fill(!1))},[Z]),R=(0,r.useCallback)(()=>{g(e=>!e)},[]),I=(0,r.useCallback)(()=>{h<m.length-1&&(u(e=>e+1),g(!1))},[h,m.length]),F=(0,r.useCallback)(()=>{h>0&&(u(e=>e-1),g(!1))},[h]),_=(0,r.useCallback)(()=>{N(e=>{let s=[...e];return s[h]=!0,s}),I()},[h,I]),D=(0,r.useCallback)(async()=>{let e=E(),t=new Date,i=Math.round((t-z.current)/1e3);await v(a,l,"flashcard",e,t,i),s(e)},[E,a,l,s]),T=(0,r.useMemo)(()=>m[h],[m,h]);return y?(0,i.jsx)("div",{children:"読み込み中..."}):k?(0,i.jsx)("div",{children:k}):0===m.length?(0,i.jsx)("div",{children:"フラッシュカードがありません。"}):(0,i.jsxs)("div",{className:"p-2 w-full max-w-[390px] mx-auto",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:t,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h2",{className:"text-xl font-bold",children:"フラッシュカード"}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:q,className:"mr-2",children:(0,i.jsx)(e5.Z,{})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:D,children:"終了"})]})]}),(0,i.jsx)("div",{className:se().flashcardContainer,onClick:R,children:(0,i.jsxs)("div",{className:"".concat(se().flashcard," ").concat(f?se().flipped:""),children:[(0,i.jsx)("div",{className:se().front,children:(0,i.jsx)(ss,{content:T.front,image:T.image,isFront:!0})}),(0,i.jsx)("div",{className:se().back,children:(0,i.jsx)(ss,{content:T.back,isFront:!1})})]})}),(0,i.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,i.jsxs)(B,{onClick:F,disabled:0===h,children:[(0,i.jsx)(ey.Z,{className:"mr-2 h-4 w-4"})," 前へ"]}),(0,i.jsxs)("span",{children:[h+1," / ",m.length]}),(0,i.jsxs)(B,{onClick:I,disabled:h===m.length-1,children:["次へ ",(0,i.jsx)(e9.Z,{className:"ml-2 h-4 w-4"})]})]}),(0,i.jsx)("div",{className:"mt-4 flex justify-center",children:(0,i.jsxs)(B,{onClick:_,className:"mr-2",children:[(0,i.jsx)(e7.Z,{className:"mr-2 h-4 w-4"})," 覚えた"]})})]})},sa=e=>{let{onFinish:s,onBack:t,setId:a,title:l,quizType:c,sessionState:n}=e,[o,d]=(0,r.useState)([]),[m,x]=(0,r.useState)(0),[h,u]=(0,r.useState)(""),[f,g]=(0,r.useState)(!1),[b,N]=(0,r.useState)([]),[y,C]=(0,r.useState)(!0),[k,S]=(0,r.useState)(null),[z,E]=(0,r.useState)(!1),[Z,D]=(0,r.useState)([]),T=(0,r.useRef)(new Date);(0,r.useEffect)(()=>{(async()=>{try{C(!0);let e=[];if(e=null===a?(await j("qa")).flatMap(e=>e.qaItems):(await p(parseInt(a))).qaItems,Array.isArray(e))d(e),n?(D(n.shuffledQuestions),x(n.currentQuestionIndex),N(n.results)):(D(A([...e])),N(Array(e.length).fill(null)));else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),S("質問の読み込み中にエラーが発生しました。")}finally{C(!1)}})()},[a,n]),(0,r.useEffect)(()=>{(async()=>{a&&await w(a,"qa",{shuffledQuestions:Z,currentQuestionIndex:m,results:b})})()},[a,Z,m,b]);let A=(0,r.useCallback)(e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},[]),M=(0,r.useCallback)(()=>{D(A([...o])),x(0),u(""),g(!1),N(Array(o.length).fill(null)),E(!1)},[o,A]),O=(0,r.useCallback)(()=>{let e=h.toLowerCase()===Z[m].answer.toLowerCase(),s=[...b];s[m]=e,N(s),g(!0),m<Z.length-1?setTimeout(()=>{x(e=>e+1),u(""),g(!1)},1e3):E(!0)},[h,Z,m,b]),L=(0,r.useCallback)(async()=>{let e=Q(),t=new Date,i=Math.round((t-T.current)/1e3);await v(a,l,"qa",e,t,i),s(e)},[a,l,s]),Q=(0,r.useCallback)(()=>{let e=Z.length;return Math.round(b.filter(Boolean).length/e*100)},[Z.length,b]);if(y)return(0,i.jsx)("div",{children:"読み込み中..."});if(k)return(0,i.jsx)("div",{children:k});if(0===Z.length)return(0,i.jsx)("div",{children:"質問がありません。"});let U=Z[m];if(z){let e=Q();return(0,i.jsx)("div",{className:"p-4 max-w-md mx-auto",children:(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsx)(I,{className:"text-xl font-bold",children:"クイズ終了"})}),(0,i.jsxs)(F,{children:[(0,i.jsxs)("p",{className:"text-lg mb-4",children:["最終スコア: ",e,"%"]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)(B,{onClick:M,children:"もう一度挑戦"}),(0,i.jsx)(B,{onClick:()=>s(e),children:"終了"})]})]})]})})}return(0,i.jsxs)("div",{className:"w-full max-w-md mx-auto px-4",children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:t,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h2",{className:"text-xl font-bold",children:"一問一答"}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:M,children:(0,i.jsx)(e5.Z,{})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:L,children:"終了"})]})]})}),(0,i.jsxs)(q,{className:"w-full mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsx)(I,{className:"text-lg",children:U.question})}),(0,i.jsxs)(F,{children:[U.image&&(0,i.jsx)("img",{src:U.image,alt:"Question",className:"w-full mb-4 max-h-48 object-contain"}),(0,i.jsx)(ex,{type:"text",placeholder:"回答を入力",value:h,onChange:e=>u(e.target.value),disabled:f})]}),(0,i.jsx)(_,{className:"flex justify-between",children:f?(0,i.jsxs)("div",{className:"flex items-center text-sm",children:[b[m]?(0,i.jsx)(eZ.Z,{className:"text-green-500 mr-2"}):(0,i.jsx)(ea.Z,{className:"text-red-500 mr-2"}),(0,i.jsxs)("span",{children:["正解: ",U.answer]})]}):(0,i.jsx)(B,{onClick:O,children:"回答する"})})]}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("span",{children:[m+1," / ",Z.length]})})]})},sl=e=>{let{onFinish:s,onBack:t,setId:a,title:l,quizType:c,sessionState:n}=e,[o,d]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[h,u]=(0,r.useState)(0),[f,g]=(0,r.useState)([]),[b,N]=(0,r.useState)(!1),[y,C]=(0,r.useState)([]),[k,S]=(0,r.useState)(!0),[z,E]=(0,r.useState)(null),[Z,D]=(0,r.useState)(!1),T=(0,r.useRef)(new Date),A=(0,r.useCallback)(()=>{let e=m.length;return Math.round(y.filter(Boolean).length/e*100)},[m.length,y]),M=(0,r.useCallback)(e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},[]),O=(0,r.useCallback)(e=>({...e,choices:M(e.choices)}),[M]);(0,r.useEffect)(()=>{(async()=>{try{S(!0);let e=[];if(e=null===a?(await j("multiple-choice")).flatMap(e=>e.questions):(await p(parseInt(a))).questions,Array.isArray(e)){if(d(e),n)x(n.shuffledQuestions),u(n.currentQuestionIndex),C(n.results);else{let s=e.map(O),t=M(s);x(t),C(Array(t.length).fill(null))}}else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),E("問題の読み込み中にエラーが発生しました。")}finally{S(!1)}})()},[a,n,M,O]),(0,r.useEffect)(()=>{(async()=>{a&&await w(a,"multiple-choice",{shuffledQuestions:m,currentQuestionIndex:h,results:y})})()},[a,m,h,y]);let L=(0,r.useCallback)(()=>{let e=M(o.map(O));x(e),u(0),g([]),N(!1),C(Array(e.length).fill(null)),D(!1)},[o,M,O]),Q=(0,r.useCallback)(e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},[]),U=(0,r.useCallback)(()=>{if(f.length>0&&h<m.length){let e=m[h].choices.every((e,s)=>f.includes(s)===e.isCorrect),s=[...y];s[h]=e,C(s),N(!0),h<m.length-1?setTimeout(()=>{u(e=>e+1),g([]),N(!1)},1e3):D(!0)}},[f,h,m,y]),V=(0,r.useCallback)(async()=>{let e=A(),t=new Date,i=Math.round((t-T.current)/1e3);await v(a,l,"multiple-choice",e,t,i),s(e)},[a,l,A,s]);if(k)return(0,i.jsx)("div",{className:"w-full max-w-md mx-auto px-4",children:"読み込み中..."});if(z)return(0,i.jsx)("div",{className:"w-full max-w-md mx-auto px-4",children:z});if(0===m.length)return(0,i.jsx)("div",{className:"w-full max-w-md mx-auto px-4",children:"質問がありません。"});let H=m[h];if(Z){let e=A();return(0,i.jsx)("div",{className:"w-full max-w-md mx-auto px-4",children:(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsx)(I,{className:"text-xl font-bold",children:"クイズ終了"})}),(0,i.jsxs)(F,{children:[(0,i.jsxs)("p",{className:"text-lg mb-4",children:["最終スコア: ",e,"%"]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)(B,{onClick:L,children:"もう一度挑戦"}),(0,i.jsx)(B,{onClick:()=>s(e),children:"終了"})]})]})]})})}return(0,i.jsxs)("div",{className:"w-full max-w-md mx-auto px-4",children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:t,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h2",{className:"text-xl font-bold",children:"多肢選択問題"}),(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:L,className:"mr-2",children:(0,i.jsx)(e5.Z,{})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:V,children:"終了"})]})]})}),(0,i.jsxs)(q,{className:"w-full mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsx)(I,{children:H.question})}),(0,i.jsxs)(F,{children:[H.image&&(0,i.jsx)("img",{src:H.image,alt:"Question",className:"w-full mb-4"}),(0,i.jsx)("div",{className:"grid grid-cols-2 gap-2",children:H.choices.map((e,s)=>(0,i.jsx)(B,{variant:f.includes(s)?"default":"outline",className:"justify-start ".concat(b&&e.isCorrect?"bg-green-100":""),onClick:()=>!b&&Q(s),disabled:b,children:e.text},s))})]}),(0,i.jsx)(_,{className:"flex justify-between",children:b?(0,i.jsxs)("div",{className:"flex items-center",children:[y[h]?(0,i.jsx)(eZ.Z,{className:"text-green-500 mr-2"}):(0,i.jsx)(ea.Z,{className:"text-red-500 mr-2"}),(0,i.jsxs)("span",{children:["正解: ",H.choices.filter(e=>e.isCorrect).map(e=>e.text).join(", ")]})]}):(0,i.jsx)(B,{onClick:U,disabled:0===f.length,children:"回答する"})})]}),(0,i.jsx)("div",{className:"text-center",children:(0,i.jsxs)("span",{children:[h+1," / ",m.length]})})]})},si=t(5149),sr=t(5392);function sc(e){let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s}var sn=t(5554);function so(e){let{attributes:s,listeners:t,setNodeRef:a,transform:l,transition:r}=(0,sr.nB)({id:e.id}),c={transform:sn.ux.Transform.toString(l),transition:r};return(0,i.jsx)("div",{ref:a,style:c,...s,...t,className:"bg-white p-2 mb-2 rounded border cursor-move",children:e.children})}var sd=e=>{var s;let{onFinish:t,onBack:a,setId:c,title:n,quizType:o,sessionState:d}=e,[m,x]=(0,r.useState)({question:null,categories:[],items:[],correctClassification:{},isFinished:!1,showResults:!1,score:0}),[h,u]=(0,r.useState)(!0),[f,j]=(0,r.useState)(null),[g,b]=(0,r.useState)(null),[N,y]=(0,r.useState)(null),[C,k]=(0,r.useState)({}),[S,z]=(0,r.useState)({}),[E,Z]=(0,r.useState)([]),[R,I]=(0,r.useState)({}),[_,D]=(0,r.useState)([]),T=(0,r.useRef)(new Date),{width:A,height:M}=function(){let[e,s]=(0,r.useState)({width:void 0,height:void 0});return(0,r.useEffect)(()=>{function e(){s({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),e}(),[O,L]=(0,r.useState)(0),Q=(0,si.Dy)((0,si.VT)(si.we,{activationConstraint:{distance:8,delay:100,tolerance:5}}));(0,r.useEffect)(()=>{let e=e=>e.preventDefault();return document.addEventListener("touchmove",e,{passive:!1}),()=>document.removeEventListener("touchmove",e)},[]),(0,r.useEffect)(()=>{(async()=>{try{u(!0);let e=await p(c);if(e&&Array.isArray(e.categories)){if(d)x(d.quizData),Z(d.shuffledItems),D(d.shuffledCategories),L(d.currentItemIndex),I(d.classifiedItems);else{let s=e.categories.flatMap(e=>e.items.map((s,t)=>({id:"".concat(e.name,"-").concat(t),content:s,category:null,isClassified:!1}))),t=sc(s),a=e.categories.reduce((e,s)=>(e[s.name]=s.items,e),{});x({question:null,categories:e.categories,items:s,correctClassification:a,isFinished:!1,showResults:!1,score:0}),Z(t),D(sc(e.categories)),L(0),I({})}}else throw Error("Invalid data structure")}catch(e){console.error("Error loading question:",e),j("質問の読み込中にエラーが発生しました。")}finally{u(!1)}})()},[c,d]),(0,r.useEffect)(()=>{(async()=>{c&&await w(c,"classification",{quizData:m,shuffledItems:E,shuffledCategories:_,currentItemIndex:O,classifiedItems:R})})()},[c,m,E,_,O,R]);let U=(0,r.useCallback)(()=>{Z(sc(E)),D(sc(_)),L(0)},[E,_]),V=(0,r.useCallback)(e=>{let{active:s}=e;b(s.id)},[]),H=(0,r.useCallback)(e=>{let{over:s}=e;y(s?s.id:null)},[]),J=(0,r.useCallback)(e=>{let{active:s,over:t}=e;t&&s.id!==t.id&&x(e=>{var a;let l=e.items.map(e=>e.id===s.id?{...e,category:t.id,isClassified:!0}:e);I(e=>({...e,[t.id]:[...e[t.id]||[],s.id]}));let i=l.filter(e=>e.isClassified).length,r=l.filter(s=>{var t;return s.isClassified&&(null===(t=e.correctClassification[s.category])||void 0===t?void 0:t.includes(s.content))}).length,c=l.every(e=>e.isClassified),n=null===(a=e.correctClassification[t.id])||void 0===a?void 0:a.includes(l.find(e=>e.id===s.id).content);return z(e=>({...e,[t.id]:n?"bg-green-200":"bg-red-200"})),O<E.length-1?L(O+1):L(E.length-1),{...e,items:l,score:i>0?Math.round(r/i*100):0,isFinished:c,showResults:c}}),b(null),y(null)},[E,O]);(0,r.useEffect)(()=>{if(Object.keys(S).length>0){let e=setTimeout(()=>{z({})},500);return()=>clearTimeout(e)}},[S]);let P=(0,r.useCallback)(()=>{(async()=>{try{u(!0);let e=await p(c);if(e&&Array.isArray(e.categories)){let s=e.categories.flatMap(e=>e.items.map((s,t)=>({id:"".concat(e.name,"-").concat(t),content:s,category:null,isClassified:!1}))),t=sc(s),a=e.categories.reduce((e,s)=>(e[s.name]=s.items,e),{});x({question:null,categories:e.categories,items:s,correctClassification:a,isFinished:!1,showResults:!1,score:0}),Z(t),D(sc(e.categories)),L(0),I({}),z({}),T.current=new Date}else throw Error("Invalid data structure")}catch(e){console.error("Error loading question:",e),j("質問の読み込中にエラーが発生しました。")}finally{u(!1)}})()},[c]),G=(0,r.useCallback)(async()=>{let e=m.score,s=new Date,a=Math.round((s-T.current)/1e3);await v(c,n,"classification",e,s,a),t(e)},[t,m.score,c,n]),X=(0,r.useCallback)(()=>({display:"grid",gridTemplateColumns:"repeat(".concat(3,", 1fr)"),gridTemplateRows:"repeat(".concat(4,", 1fr)"),gap:"0.5rem",height:"100%"}),[]),Y=(0,r.useMemo)(()=>X(),[X]),W=(0,r.useMemo)(()=>[{col:3,row:2},{col:3,row:3},{col:1,row:2},{col:1,row:3},{col:2,row:1},{col:2,row:4},{col:3,row:1},{col:3,row:4},{col:1,row:1},{col:1,row:4}],[]);return h?(0,i.jsx)("div",{children:"読み込み中..."}):f?(0,i.jsx)("div",{children:f}):(0,i.jsxs)("div",{className:"flex flex-col h-screen w-screen p-2",children:[(0,i.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:a,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h2",{className:"text-xl font-bold",children:"分類クイズ"}),(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:U,className:"mr-2",children:(0,i.jsx)(e5.Z,{})}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:G,className:"mr-2",children:"終了"}),(0,i.jsxs)("span",{className:"text-lg font-bold",children:["スコア: ",m.score,"%"]})]})]}),(0,i.jsx)(q,{className:"flex-grow overflow-hidden",children:(0,i.jsx)(F,{className:"h-full p-2",children:m.showResults?(0,i.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-24",children:[(0,i.jsx)(B,{onClick:P,className:"transform rotate-90 w-32 h-12",children:(0,i.jsx)("span",{className:"inline-block text-sm",children:"もう一度挑戦"})}),(0,i.jsx)(B,{onClick:G,className:"transform rotate-90 w-32 h-12",children:(0,i.jsx)("span",{className:"inline-block text-sm",children:"終了"})})]}),(0,i.jsxs)("h2",{className:"text-2xl font-bold transform rotate-90 whitespace-nowrap",children:["最終スコア: ",m.score,"%"]})]}):(0,i.jsxs)(si.LB,{sensors:Q,onDragStart:V,onDragOver:H,onDragEnd:J,children:[(0,i.jsxs)("div",{className:"h-full",style:Y,children:[_.map((e,s)=>(0,i.jsx)(l.DroppableCategory,{category:e,isActive:N===e.name,feedbackColor:S[e.name]||C[e.name],style:{gridColumn:W[s].col,gridRow:W[s].row}},e.name)),(0,i.jsx)("div",{className:"col-start-2 row-start-2 row-span-2 flex items-center justify-center",children:E[O]&&(0,i.jsx)(sr.Fo,{items:[E[O]],strategy:sr.qw,children:(0,i.jsx)(so,{id:E[O].id,isDragging:E[O].id===g,isClassified:!1,children:E[O].content})})})]}),(0,i.jsx)(si.y9,{children:g?(0,i.jsx)("div",{className:"bg-white p-4 rounded border shadow-lg text-2xl font-semibold transform rotate-90",children:null===(s=m.items.find(e=>e.id===g))||void 0===s?void 0:s.content}):null})]})})})]})},sm=t(7592),sx=e=>{let{onBack:s,overallProgress:t,streak:a,dailyGoal:l,todayStudyTime:r,onShowStudyHistory:c}=e;return(0,i.jsxs)("div",{className:"p-4 w-full max-w-3xl mx-auto",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"統計"})]}),(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsxs)(I,{className:"flex items-center",children:[(0,i.jsx)($.Z,{className:"mr-2 text-blue-500",size:24}),"全体の進捗"]})}),(0,i.jsxs)(F,{children:[(0,i.jsx)(O,{value:t,className:"w-full"}),(0,i.jsxs)("p",{className:"text-center mt-2 font-bold",children:[t.toFixed(1),"%"]})]})]}),(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsxs)(I,{className:"flex items-center",children:[(0,i.jsx)(W.Z,{className:"mr-2 text-yellow-500",size:24}),"学習継続日数"]})}),(0,i.jsxs)(F,{children:[(0,i.jsxs)("p",{className:"text-lg font-bold",children:["現在のストリーク: ",a,"日"]}),(0,i.jsxs)("p",{children:["過去最高ストリーク: ",10,"日"]})]})]}),(0,i.jsxs)(q,{className:"mb-4",children:[(0,i.jsx)(R,{children:(0,i.jsxs)(I,{className:"flex items-center",children:[(0,i.jsx)(es.Z,{className:"mr-2 text-green-500",size:24}),"今日の学習時間"]})}),(0,i.jsxs)(F,{children:[(0,i.jsx)(O,{value:r/l*100,className:"w-full mb-2"}),(0,i.jsxs)("p",{children:[r,"分 / ",l,"分"]})]})]}),(0,i.jsx)(q,{className:"mb-4 w-full cursor-pointer",onClick:c,children:(0,i.jsx)(R,{children:(0,i.jsxs)(I,{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)(ee.Z,{className:"mr-2 text-purple-500",size:24}),"学習履歴"]}),(0,i.jsx)(sm.Z,{size:24})]})})})]})},sh=t(9646);let su=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,i.jsx)(sh.fC,{className:Z("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,i.jsx)(sh.bU,{className:Z("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});su.displayName=sh.fC.displayName;var sf=e=>{let{onBack:s,dailyGoal:t,setDailyGoal:a,darkMode:l,setDarkMode:c}=e,[n,o]=(0,r.useState)(t);return(0,i.jsxs)("div",{className:"p-4 w-full",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:s,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"設定"})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"1日の学習目標（分）"}),(0,i.jsx)(ex,{type:"number",value:n,onChange:e=>o(Number(e.target.value)),min:"1",max:"1440"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"ダークモード"}),(0,i.jsx)(su,{checked:l,onCheckedChange:c})]}),(0,i.jsx)(B,{onClick:()=>{a(n),s()},className:"w-full",children:"保存"})]})]})},sj=e=>{let{studyHistory:s,onDeleteEntry:t,onBack:a}=e,[l,c]=(0,r.useState)("all"),[n,o]=(0,r.useState)([]);return(0,r.useEffect)(()=>{o((()=>{let e=new Date;return s.filter(s=>{if("all"===l)return!0;let t=new Date(s.date);switch(l){case"week":return e-t<=6048e5;case"month":return e-t<=2592e6;case"year":return e.getFullYear()===t.getFullYear();default:return!0}})})())},[s,l]),(0,i.jsxs)("div",{className:"p-4 w-full max-w-3xl mx-auto",children:[(0,i.jsxs)("div",{className:"flex items-center mb-6",children:[(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:a,children:(0,i.jsx)(ey.Z,{})}),(0,i.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"学習履歴"})]}),(0,i.jsxs)(eq,{value:l,onValueChange:c,children:[(0,i.jsx)(eI,{className:"w-full mb-4",children:(0,i.jsx)(eR,{placeholder:"期間を選択"})}),(0,i.jsxs)(eD,{children:[(0,i.jsx)(eT,{value:"all",children:"全期間"}),(0,i.jsx)(eT,{value:"week",children:"過去1週間"}),(0,i.jsx)(eT,{value:"month",children:"過去1ヶ月"}),(0,i.jsx)(eT,{value:"year",children:"今年"})]})]}),n.map((e,s)=>(0,i.jsxs)(q,{className:"mb-4 w-full",children:[(0,i.jsx)(R,{children:(0,i.jsxs)(I,{className:"flex items-center justify-between",children:[(0,i.jsx)("div",{children:e.setTitle}),(0,i.jsx)(B,{variant:"ghost",size:"icon",onClick:()=>t(e.id),children:(0,i.jsx)(ej.Z,{className:"text-red-500",size:20})})]})}),(0,i.jsxs)(F,{children:[(0,i.jsxs)("p",{children:["日付: ",new Date(e.date).toLocaleDateString()]}),(0,i.jsxs)("p",{children:["スコア: ",e.score,"%"]})]})]},s))]})};function sg(){let{hashPath:e,push:s,isReady:t}=function(){let[e,s]=(0,r.useState)(""),[t,a]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=()=>{let e=window.location.hash.slice(1);console.log("Hash changed to:",e),s(e)};return e(),window.addEventListener("hashchange",e),a(!0),()=>{window.removeEventListener("hashchange",e)}},[]),{hashPath:e,push:e=>{console.log("Pushing path:",e),window.location.hash=e},isReady:t}}(),[a,l]=(0,r.useState)("home"),[c,n]=(0,r.useState)(null),[o,d]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[h,u]=(0,r.useState)(null),[f,j]=(0,r.useState)(null),[g,b]=(0,r.useState)(0),[N,v]=(0,r.useState)(0),[w,k]=(0,r.useState)([]),[z,E]=(0,r.useState)(60),[Z,q]=(0,r.useState)(0),[R,I]=(0,r.useState)(null),[F,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&!e&&s("home")},[t,e,s]),(0,r.useEffect)(()=>{console.log("Current hash path:",e);let[s,t]=e.split("/");switch(s){case"":case"home":default:l("home");break;case"createEditSet":l("createEditSet");break;case"quizTypeSelection":l("quizTypeSelection");break;case"flashcard":case"qa":case"multiple-choice":case"classification":n(s),l("edit"===t?"".concat(s,"Edit"):"".concat(s,"Creation"));break;case"quiz":l("quiz");break;case"statistics":l("statistics");break;case"settings":l("settings");break;case"studyHistory":l("studyHistory")}},[e]),(0,r.useEffect)(()=>{(async()=>{k(await y())})()},[]);let D=async e=>{await S(e),k(s=>s.filter(s=>s.id!==e))},T=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log("Navigating to:",e,t),s(t?"".concat(e,"/").concat(t):e)},A=()=>{T("createEditSet")},B=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(console.log("handleStartLearning called",{setId:e,setType:s,savedSessionState:t}),t){x(s),u(e),I(t);try{let s=await p(e);j(s.title),T("quiz")}catch(e){console.error("Error fetching set title:",e)}}else T("quizTypeSelection")},M=async(e,s)=>{try{let t=null;if(null!==s&&(t=parseInt(s,10),isNaN(t)))throw Error("Invalid setId");let a=await C(t,e);if(x(e),u(t),I(a),null===t)j("すべてのセット");else{let e=await p(t);j(e.title)}T("quiz")}catch(e){console.error("Error fetching set data:",e)}},O=()=>{T("statistics")},L=e=>{n(e),T(e,"creation")},Q=e=>{n(e),T(e,"edit")},U=e=>{console.log("Saving data:",e),T("home")},V=e=>{console.log("Quiz finished with results:",e),T("home")},H=()=>{T("settings")},J=()=>{T("studyHistory")};return t?(0,i.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-4",children:(()=>{switch(console.log("Rendering screen:",a),a){case"home":return(0,i.jsx)(ep,{onCreateSet:A,onStartLearning:B,onShowStatistics:O,onOpenSettings:H,overallProgress:g,setOverallProgress:b,streak:N,setStreak:v,studyHistory:w,setStudyHistory:k,dailyGoal:z,setDailyGoal:E,todayStudyTime:Z,setTodayStudyTime:q});case"createEditSet":return(0,i.jsx)(ek,{onBack:()=>T("home"),onSelectType:L,onEditType:Q});case"quizTypeSelection":return(0,i.jsx)(eB,{onBack:()=>T("home"),onStartQuiz:M});case"flashcardCreation":return(0,i.jsx)(eX,{onBack:()=>T("createEditSet"),onSave:U});case"flashcardEdit":return(0,i.jsx)(eY,{onBack:()=>T("createEditSet"),onSave:U});case"qaCreation":return(0,i.jsx)(eW,{onBack:()=>T("createEditSet"),onSave:U});case"qaEdit":return(0,i.jsx)(e$,{onBack:()=>T("createEditSet"),onSave:U});case"multiple-choiceCreation":return(0,i.jsx)(e2,{onBack:()=>T("createEditSet"),onSave:U});case"multiple-choiceEdit":return(0,i.jsx)(e4,{onBack:()=>T("createEditSet"),onSave:U});case"classificationCreation":return(0,i.jsx)(e3,{onBack:()=>T("createEditSet"),onSave:U});case"classificationEdit":return(0,i.jsx)(e6,{onBack:()=>T("createEditSet"),onSave:U});case"quiz":switch(m){case"flashcard":return(0,i.jsx)(st,{setId:h,title:f,quizType:m,onBack:()=>T("quizTypeSelection"),onFinish:V,sessionState:R});case"qa":return(0,i.jsx)(sa,{setId:h,title:f,quizType:m,onBack:()=>T("quizTypeSelection"),onFinish:V,sessionState:R});case"multiple-choice":return(0,i.jsx)(sl,{setId:h,title:f,quizType:m,onBack:()=>T("quizTypeSelection"),onFinish:V,sessionState:R});case"classification":return(0,i.jsx)(sd,{setId:h,title:f,quizType:m,onBack:()=>T("quizTypeSelection"),onFinish:V,sessionState:R});default:return null}case"statistics":return(0,i.jsx)(sx,{onBack:()=>T("home"),overallProgress:g,streak:N,studyHistory:w,dailyGoal:z,todayStudyTime:Z,onShowStudyHistory:J});case"settings":return(0,i.jsx)(sf,{onBack:()=>T("home"),dailyGoal:z,setDailyGoal:E,darkMode:F,setDarkMode:_});case"studyHistory":return(0,i.jsx)(sj,{studyHistory:w,onDeleteEntry:D,onBack:()=>T("statistics")});default:return(0,i.jsxs)("div",{children:["Unknown screen: ",a]})}})()}):null}function sp(){return(0,i.jsx)(sg,{})}},7662:function(e){e.exports={flashcardContainer:"FlashcardQuiz_flashcardContainer__aqgvO",flashcard:"FlashcardQuiz_flashcard__08I4i",flipped:"FlashcardQuiz_flipped__cz657",front:"FlashcardQuiz_front__NwySn",back:"FlashcardQuiz_back__OO3St",flashcardContent:"FlashcardQuiz_flashcardContent___HmBG",contentText:"FlashcardQuiz_contentText__lOnRg",imageContainer:"FlashcardQuiz_imageContainer__n1XEq",contentImage:"FlashcardQuiz_contentImage__tgCTr",frontContent:"FlashcardQuiz_frontContent__leEmF",backContent:"FlashcardQuiz_backContent__rjCyJ"}}},function(e){e.O(0,[947,208,358,749,971,23,744],function(){return e(e.s=4990)}),_N_E=e.O()}]);