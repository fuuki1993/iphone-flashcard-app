(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8352:function(e,s,t){Promise.resolve().then(t.bind(t,4911))},4911:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return e9}});var a=t(7437),l=t(2265);let i="sets",r="studyHistory",n=()=>new Promise((e,s)=>{let t=indexedDB.open("FlashcardApp",3);t.onerror=()=>s("Error opening database"),t.onsuccess=s=>e(s.target.result),t.onupgradeneeded=e=>{let s=e.target.result;s.objectStoreNames.contains(i)||s.createObjectStore(i,{keyPath:"id",autoIncrement:!0}).createIndex("type","type",{unique:!1}),s.objectStoreNames.contains(r)||s.createObjectStore(r,{keyPath:"id",autoIncrement:!0}).createIndex("date","date",{unique:!1})}}),c=async(e,s,t,a,l)=>{let i=await n();return new Promise((n,c)=>{let o=i.transaction([r],"readwrite").objectStore(r),d={setId:e,setTitle:s,setType:t,score:a,date:l.toISOString()},m=o.add(d);m.onerror=()=>c("Error saving study history"),m.onsuccess=()=>n(m.result)})},o=async()=>{let e=await n();return new Promise((s,t)=>{let a=e.transaction([r],"readonly").objectStore(r).getAll();a.onerror=()=>t("Error getting study history"),a.onsuccess=()=>{s(a.result.sort((e,s)=>new Date(s.date)-new Date(e.date)))}})},d=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readwrite").objectStore(i).add(e);l.onerror=()=>a("Error saving set"),l.onsuccess=()=>t(l.result)})},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=await n();return new Promise((t,a)=>{let l;let r=s.transaction([i],"readonly").objectStore(i);(l=e?r.index("type").getAll(e):r.getAll()).onerror=()=>a("Error getting sets"),l.onsuccess=()=>t(l.result)})},x=async()=>{let e=await n();return new Promise((s,t)=>{let a=e.transaction(i,"readonly").objectStore(i).getAll();a.onerror=()=>t("Error getting all sets"),a.onsuccess=()=>s(a.result)})},h=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readonly").objectStore(i).get(e);l.onerror=()=>a("Error getting set"),l.onsuccess=()=>t(l.result)})},u=async e=>{let s=await n();return new Promise((t,a)=>{let l=s.transaction([i],"readwrite").objectStore(i).put(e);l.onerror=()=>a("Error updating set"),l.onsuccess=()=>t(l.result)})};var f=t(4839),j=t(6164);function g(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,j.m6)((0,f.W)(s))}let p=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:g("rounded-lg border bg-card text-card-foreground shadow-sm",t),...l})});p.displayName="Card";let b=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:g("flex flex-col space-y-1.5 p-6",t),...l})});b.displayName="CardHeader";let N=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h3",{ref:s,className:g("text-2xl font-semibold leading-none tracking-tight",t),...l})});N.displayName="CardTitle",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("p",{ref:s,className:g("text-sm text-muted-foreground",t),...l})}).displayName="CardDescription";let v=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:g("p-6 pt-0",t),...l})});v.displayName="CardContent";let y=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:g("flex items-center p-6 pt-0",t),...l})});y.displayName="CardFooter";var w=t(1538),C=t(2218);let S=(0,C.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),k=l.forwardRef((e,s)=>{let{className:t,variant:l,size:i,asChild:r=!1,...n}=e,c=r?w.g7:"button";return(0,a.jsx)(c,{className:g(S({variant:l,size:i,className:t})),ref:s,...n})});k.displayName="Button";var Z=t(6506);let z=l.forwardRef((e,s)=>{let{className:t,value:l,indicatorClassName:i,...r}=e;return(0,a.jsx)(Z.fC,{ref:s,className:g("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:(0,a.jsx)(Z.z$,{className:g("h-full w-full flex-1 bg-primary transition-all",i),style:{transform:"translateX(-".concat(100-(l||0),"%)")}})})});z.displayName=Z.fC.displayName;var q=t(9385);let E=q.fC,I=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.aV,{ref:s,className:g("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});I.displayName=q.aV.displayName;let R=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.xz,{ref:s,className:g("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});R.displayName=q.xz.displayName;let T=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(q.VY,{ref:s,className:g("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});T.displayName=q.VY.displayName;var D=t(8948),F=t(4436),A=t(7746),_=t(4241),O=t(4258),M=t(5016),B=t(7427),V=t(6273),L=t(6540),P=t(933),Q=t(3304),U=t(4697);let H=Q.fC;Q.xz;let Y=Q.h_;Q.x8;let G=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.aV,{ref:s,className:g("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});G.displayName=Q.aV.displayName;let $=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(Y,{children:[(0,a.jsx)(G,{}),(0,a.jsxs)(Q.VY,{ref:s,className:g("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...i,children:[l,(0,a.jsxs)(Q.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(U.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});$.displayName=Q.VY.displayName;let J=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:g("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};J.displayName="DialogHeader";let W=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:g("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};W.displayName="DialogFooter";let X=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.Dx,{ref:s,className:g("text-lg font-semibold leading-none tracking-tight",t),...l})});X.displayName=Q.Dx.displayName;let K=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(Q.dk,{ref:s,className:g("text-sm text-muted-foreground",t),...l})});K.displayName=Q.dk.displayName;let ee=l.forwardRef((e,s)=>{let{className:t,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:g("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});ee.displayName="Input";var es=t(8364);let et=(0,C.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ea=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(es.f,{ref:s,className:g(et(),t),...l})});ea.displayName=es.f.displayName;var el=t(883),ei=e=>{let{isOpen:s,onClose:t,onSave:i,onDelete:r,editingEvent:n}=e,[c,o]=(0,l.useState)(""),[d,m]=(0,l.useState)(""),[x,h]=(0,l.useState)("");return(0,l.useEffect)(()=>{if(n){o(n.title);let e=new Date(n.date);m(e.toISOString().split("T")[0]),h(e.toTimeString().slice(0,5))}else o(""),m(""),h("")},[n]),(0,a.jsx)(H,{open:s,onOpenChange:t,children:(0,a.jsxs)($,{children:[(0,a.jsxs)(J,{children:[(0,a.jsx)(X,{children:n?"予定を編集":"予定を追加"}),(0,a.jsx)(K,{children:n?"既存の予定を編集します。":"新しい予定を追加します。"})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(ea,{htmlFor:"title",className:"text-right",children:"タイトル"}),(0,a.jsx)(ee,{id:"title",value:c,onChange:e=>o(e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(ea,{htmlFor:"date",className:"text-right",children:"日付"}),(0,a.jsx)(ee,{id:"date",type:"date",value:d,onChange:e=>m(e.target.value),className:"col-span-3"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,a.jsx)(ea,{htmlFor:"time",className:"text-right",children:"時間"}),(0,a.jsx)(ee,{id:"time",type:"time",value:x,onChange:e=>h(e.target.value),className:"col-span-3"})]})]}),(0,a.jsxs)(W,{children:[n&&(0,a.jsxs)(k,{variant:"destructive",onClick:()=>{n&&(r(n.id),t())},children:[(0,a.jsx)(el.Z,{className:"mr-2 h-4 w-4"}),"削除"]}),(0,a.jsx)(k,{onClick:()=>{let e=new Date("".concat(d,"T").concat(x));i({id:null==n?void 0:n.id,title:c,date:e}),t()},children:"保存"})]})]})})},er=e=>{let{onCreateSet:s,onStartLearning:t,onShowStatistics:i,overallProgress:r,setOverallProgress:n,streak:c,setStreak:d,studyHistory:m,setStudyHistory:h,dailyGoal:u,setDailyGoal:f,todayStudyTime:j,setTodayStudyTime:g}=e,[y,w]=(0,l.useState)(!1),[C,S]=(0,l.useState)([]),[Z,q]=(0,l.useState)(!1),[Q,U]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await o(),s=await x(),t=0,a=0;s.forEach(e=>{"flashcard"===e.type||"qa"===e.type?t+=e.cards?e.cards.length:0:("multiple-choice"===e.type||"classification"===e.type)&&(t+=e.questions?e.questions.length:0)}),e.forEach(e=>{let s=Math.round(e.score/100*(e.totalQuestions||1));a+=s});let l=t>0?a/t*100:0;n(Math.round(l));let i=new Date().toISOString().split("T")[0],r=e.filter(e=>e.date.startsWith(i)).reduce((e,s)=>e+(s.duration||0),0);g(r),w(r>=u);let c=Array.from(new Set(e.map(e=>e.setId))).slice(0,3).map(s=>e.find(e=>e.setId===s));h(c)}catch(e){console.error("Error loading study data:",e)}})()},[u,n,g,h]);let H=(0,l.useCallback)(()=>{y?d(e=>e+1):d(0)},[y]);(0,l.useEffect)(()=>{H()},[y,H]);let Y=e=>{switch(e){case"flashcard":default:return(0,a.jsx)(D.Z,{className:"mr-3 text-blue-500",size:24});case"qa":return(0,a.jsx)(F.Z,{className:"mr-3 text-green-500",size:24});case"multiple-choice":return(0,a.jsx)(A.Z,{className:"mr-3 text-purple-500",size:24});case"classification":return(0,a.jsx)(_.Z,{className:"mr-3 text-red-500",size:24})}},G=e=>{let s=new Date(e),t=Math.abs(new Date-s),a=Math.floor(t/6e4),l=Math.floor(t/36e5),i=Math.floor(t/864e5);return a<60?"".concat(a,"分前"):l<24?"".concat(l,"時間前"):0===i?"今日":1===i?"昨日":"".concat(i,"日前")},$=e=>new Date(e).toLocaleString("ja-JP",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),J=e=>{U(e),q(!0)},W=e=>{let s=new Date,t=new Date(e.date).getTime()-s.getTime();t>0&&setTimeout(()=>{"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:"予定の時間です！"})},t)};return(0,l.useEffect)(()=>{"Notification"in window&&Notification.requestPermission()},[]),(0,a.jsxs)("div",{className:"p-3 w-full max-w-[390px] mx-auto bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsx)("h1",{className:"text-lg font-bold text-gray-800",children:"暗記アプリ"}),(0,a.jsx)(k,{variant:"ghost",size:"sm",onClick:()=>console.log("設定を開く"),children:(0,a.jsx)(O.Z,{className:"text-gray-600 h-5 w-5"})})]}),(0,a.jsx)(p,{className:"mb-3 bg-gray-800 text-white",children:(0,a.jsxs)(v,{className:"py-2 px-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(M.Z,{className:"mr-1 text-gray-300",size:16}),(0,a.jsxs)("span",{className:"font-bold text-xs",children:["継続: ",c,"日"]})]}),(0,a.jsxs)(k,{variant:"outline",size:"xs",onClick:i,className:"text-xs px-2 py-1 text-gray-800 bg-gray-200 hover:bg-gray-300",children:[(0,a.jsx)(B.Z,{className:"mr-1 h-3 w-3"}),"詳細"]})]}),(0,a.jsx)("p",{className:"mb-1 text-xs",children:"全体の進捗"}),(0,a.jsx)(z,{value:r,className:"w-full h-2 bg-gray-600",indicatorClassName:"bg-white"}),(0,a.jsxs)("p",{className:"text-center mt-1 text-xs",children:[r.toFixed(1),"%"]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,a.jsxs)(k,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:s,children:[(0,a.jsx)(V.Z,{className:"mr-1 h-3 w-3"}),"作成/編集"]}),(0,a.jsxs)(k,{className:"h-10 bg-gray-700 hover:bg-gray-600 text-white text-xs",onClick:t,children:[(0,a.jsx)(L.Z,{className:"mr-1 h-3 w-3"}),"学習開始"]})]}),(0,a.jsxs)(E,{defaultValue:"recent",className:"mb-3",children:[(0,a.jsxs)(I,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(R,{value:"recent",className:"text-xs",children:"最近の学習"}),(0,a.jsx)(R,{value:"scheduled",className:"text-xs",children:"予定"})]}),(0,a.jsx)(T,{value:"recent",children:(0,a.jsx)(p,{children:(0,a.jsx)(v,{className:"py-2 px-3",children:(0,a.jsx)("ul",{className:"space-y-2",children:m.map(e=>(0,a.jsxs)("li",{className:"flex items-center",children:[Y(e.setType),(0,a.jsxs)("div",{className:"flex-1 ml-2",children:[(0,a.jsx)("span",{className:"font-medium text-xs",children:e.setTitle}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:G(e.date)})]}),(0,a.jsxs)("span",{className:"text-[10px] font-medium",children:[Math.round(e.score),"%"]})]},e.id))})})})}),(0,a.jsx)(T,{value:"scheduled",children:(0,a.jsx)(p,{children:(0,a.jsxs)(v,{className:"py-2 px-3",children:[(0,a.jsx)("ul",{className:"space-y-2",children:C.map(e=>(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(_.Z,{className:"mr-3 text-blue-500",size:24}),(0,a.jsxs)("div",{className:"flex-1 cursor-pointer",onClick:()=>J(e),children:[(0,a.jsx)("span",{className:"font-medium text-xs",children:e.title}),(0,a.jsx)("p",{className:"text-[10px] text-gray-500",children:$(e.date)})]})]},e.id))}),(0,a.jsxs)(k,{className:"w-full mt-4",onClick:()=>{U(null),q(!0)},children:[(0,a.jsx)(V.Z,{className:"mr-2 h-4 w-4"}),"予定を追加"]})]})})})]}),(0,a.jsxs)(p,{children:[(0,a.jsx)(b,{className:"py-2 px-3",children:(0,a.jsxs)(N,{className:"flex items-center text-sm",children:[(0,a.jsx)(P.Z,{className:"mr-2 text-gray-600",size:16}),"今日の目標"]})}),(0,a.jsxs)(v,{className:"py-2 px-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,a.jsxs)("span",{className:"text-xs",children:[j,"分 / ",u,"分"]}),(0,a.jsx)(z,{value:j/u*100,className:"w-1/2 h-2"})]}),y&&(0,a.jsx)("p",{className:"text-gray-700 font-bold text-xs",children:"目標達成！"})]})]}),(0,a.jsx)(ei,{isOpen:Z,onClose:()=>q(!1),onSave:e=>{e.id?S(C.map(s=>s.id===e.id?e:s)):S([...C,{...e,id:Date.now()}]),W(e)},onDelete:e=>{S(C.filter(s=>s.id!==e))},editingEvent:Q})]})},en=t(5574),ec=t(374),eo=t(5931),ed=t(1266),em=t(2513),ex=t(6649),eh=e=>{let{onBack:s,onSelectType:t,onEditType:l}=e,i=[{id:"flashcard",title:"フラッシュカード",icon:L.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:en.Z,description:"質問と回答のペアを作成"},{id:"multiple-choice",title:"多肢選択",icon:ec.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:eo.Z,description:"項目をカテゴリーに分類"}];return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"セットの作成・編集"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"新規作成または編集したい学習セットのタイプを選択してください。"}),(0,a.jsx)("div",{className:"grid gap-4",children:i.map(e=>(0,a.jsxs)(p,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(N,{className:"text-lg font-medium",children:e.title}),(0,a.jsx)(e.icon,{className:"h-6 w-6 text-gray-500"})]}),(0,a.jsxs)(v,{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(k,{className:"w-full",onClick:()=>t(e.id),children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," このタイプで作成"]}),(0,a.jsxs)(k,{className:"w-full",variant:"outline",onClick:()=>l(e.id),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"})," このタイプを編集"]})]})]})]},e.id))})]})},eu=t(1543),ef=t(2421),ej=t(4392),eg=t(2468);let ep=eu.fC;eu.ZA;let eb=eu.B4,eN=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(eu.xz,{ref:s,className:g("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...i,children:[l,(0,a.jsx)(eu.JO,{asChild:!0,children:(0,a.jsx)(ef.Z,{className:"h-4 w-4 opacity-50"})})]})});eN.displayName=eu.xz.displayName;let ev=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eu.u_,{ref:s,className:g("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(ej.Z,{className:"h-4 w-4"})})});ev.displayName=eu.u_.displayName;let ey=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eu.$G,{ref:s,className:g("flex cursor-default items-center justify-center py-1",t),...l,children:(0,a.jsx)(ef.Z,{className:"h-4 w-4"})})});ey.displayName=eu.$G.displayName;let ew=l.forwardRef((e,s)=>{let{className:t,children:l,position:i="popper",...r}=e;return(0,a.jsx)(eu.h_,{children:(0,a.jsxs)(eu.VY,{ref:s,className:g("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i,...r,children:[(0,a.jsx)(ev,{}),(0,a.jsx)(eu.l_,{className:g("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:l}),(0,a.jsx)(ey,{})]})})});ew.displayName=eu.VY.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eu.__,{ref:s,className:g("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...l})}).displayName=eu.__.displayName;let eC=l.forwardRef((e,s)=>{let{className:t,children:l,...i}=e;return(0,a.jsxs)(eu.ck,{ref:s,className:g("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(eu.wU,{children:(0,a.jsx)(eg.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(eu.eT,{children:l})]})});eC.displayName=eu.ck.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eu.Z0,{ref:s,className:g("-mx-1 my-1 h-px bg-muted",t),...l})}).displayName=eu.Z0.displayName;var eS=t(8094),ek=e=>{let{onBack:s,onStartQuiz:t}=e,[i,r]=(0,l.useState)({flashcard:[],qa:[],"multiple-choice":[],classification:[]}),[n,c]=(0,l.useState)({flashcard:"",qa:"","multiple-choice":"",classification:""});(0,l.useEffect)(()=>{(async()=>{try{let e=await m("flashcard"),s=await m("qa"),t=await m("multiple-choice"),a=await m("classification");r({flashcard:e,qa:s,"multiple-choice":t,classification:a})}catch(e){console.error("Error loading sets:",e)}})()},[]);let o=[{id:"flashcard",title:"フラッシュカード",icon:L.Z,description:"表と裏のある単語カードスタイル"},{id:"qa",title:"一問一答",icon:en.Z,description:"質問と回答のペアで学習"},{id:"multiple-choice",title:"多肢選択",icon:ec.Z,description:"複数の選択肢から正解を選ぶ"},{id:"classification",title:"分類",icon:eo.Z,description:"項目をカテゴリーに分類"}],d=(e,s)=>{c(t=>({...t,[e]:s}))},x=e=>{var s,a,l;let r=n[e]||(null===(l=i[e])||void 0===l?void 0:null===(a=l[0])||void 0===a?void 0:null===(s=a.id)||void 0===s?void 0:s.toString());r&&t(e,parseInt(r,10))};return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"学習タイプを選択"})]}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"学習したいクイズタイプとセットを選択し、「学習開始」ボタンをクリックしてください。"}),(0,a.jsx)("div",{className:"space-y-4",children:o.map(e=>{var s,t,l,r;return(0,a.jsxs)(p,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center space-y-0 pb-2",children:[(0,a.jsx)(N,{className:"text-lg font-medium",children:e.title}),(0,a.jsx)(e.icon,{className:"h-6 w-6 text-gray-500 ml-2"})]}),(0,a.jsxs)(v,{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500 mb-4",children:e.description}),(0,a.jsxs)(ep,{onValueChange:s=>d(e.id,s),value:n[e.id]||(null===(l=i[e.id])||void 0===l?void 0:null===(t=l[0])||void 0===t?void 0:null===(s=t.id)||void 0===s?void 0:s.toString())||"",children:[(0,a.jsx)(eN,{className:"w-full",children:(0,a.jsx)(eb,{placeholder:"セットを選択"})}),(0,a.jsx)(ew,{children:null===(r=i[e.id])||void 0===r?void 0:r.map(e=>(0,a.jsx)(eC,{value:e.id.toString(),children:e.title},e.id))})]})]}),(0,a.jsx)(y,{children:(0,a.jsxs)(k,{className:"w-full",onClick:()=>x(e.id),children:[(0,a.jsx)(eS.Z,{className:"mr-2 h-4 w-4"})," 学習開始"]})})]},e.id)})})]})};let eZ=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:g("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});eZ.displayName="Textarea";let ez=(0,C.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eq=l.forwardRef((e,s)=>{let{className:t,variant:l,...i}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:g(ez({variant:l}),t),...i})});eq.displayName="Alert",l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h5",{ref:s,className:g("mb-1 font-medium leading-none tracking-tight",t),...l})}).displayName="AlertTitle";let eE=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:g("text-sm [&_p]:leading-relaxed",t),...l})});eE.displayName="AlertDescription";var eI=t(7019),eR=t(5733),eT=t(9061);function eD(){let e=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let s=e.current;if(!s)return;let t=()=>{setTimeout(()=>{s.scrollIntoView({behavior:"smooth",block:"center"})},100)};return s.addEventListener("focus",t),()=>{s.removeEventListener("focus",t)}},[]),e}var eF=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{front:"",back:"",image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eD(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},w=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),m(e),0===Object.keys(e).length},C=async()=>{if(w())try{let e={title:i,cards:n,type:"flashcard"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},S=e=>{h(x===e?null:e)};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(ee,{ref:u,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>S(s),className:"mobile-friendly-button",children:x===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>j(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,a.jsx)("p",{children:e.front}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Card front",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,a.jsx)("p",{children:e.back})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{ref:u,placeholder:"表面",value:e.front,onChange:e=>f(s,"front",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(eZ,{ref:u,placeholder:"裏面",value:e.back,onChange:e=>f(s,"back",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(ee,{ref:u,type:"file",accept:"image/*",onChange:e=>g(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(y,{children:o["card".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["card".concat(s)]})})})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{c([...n,{front:"",back:"",image:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,a.jsxs)(k,{onClick:C,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eA=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,f]=(0,l.useState)([]),[j,g]=(0,l.useState)({}),[w,C]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("flashcard");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let S=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),f(s.cards)}catch(e){console.error("Error loading set:",e)}},Z=(e,s,t)=>{f(x.map((a,l)=>l===e?{...a,[s]:t}:a))},z=e=>{f(x.filter((s,t)=>t!==e))},q=(e,s,t)=>{let a=t.target.files[0];if(a){let t=new FileReader;t.onloadend=()=>{Z(e,"".concat(s,"Image"),t.result)},t.readAsDataURL(a)}},E=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.front.trim()&&s.back.trim()||(e["card".concat(t)]="カードの表面と裏面を入力してください。")}),g(e),0===Object.keys(e).length},I=async()=>{if(E())try{let e={id:parseInt(n),title:o,card:x,type:"flashcard"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}},R=e=>{C(w===e?null:e)};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"フラッシュカード編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(ep,{onValueChange:S,value:n,children:[(0,a.jsx)(eN,{className:"w-full",children:(0,a.jsx)(eb,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(ew,{children:i.map(e=>(0,a.jsx)(eC,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(ee,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),j.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j.title})})]}),x.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["カード ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>R(s),className:"mobile-friendly-button",children:w===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>z(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:w===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"表面:"}),(0,a.jsx)("p",{children:e.front}),e.frontImage&&(0,a.jsx)("img",{src:e.frontImage,alt:"Card front",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"裏面:"}),(0,a.jsx)("p",{children:e.back}),e.backImage&&(0,a.jsx)("img",{src:e.backImage,alt:"Card back",className:"mt-2 max-w-full h-auto"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{placeholder:"表面",value:e.front,onChange:e=>Z(s,"front",e.target.value),className:"mb-2"}),(0,a.jsx)(ee,{type:"file",accept:"image/*",onChange:e=>q(s,"front",e),className:"mb-2"}),e.frontImage&&(0,a.jsx)("img",{src:e.frontImage,alt:"Front uploaded",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)(eZ,{placeholder:"裏面",value:e.back,onChange:e=>Z(s,"back",e.target.value),className:"mt-4 mb-2"}),(0,a.jsx)(ee,{type:"file",accept:"image/*",onChange:e=>q(s,"back",e),className:"mb-2"}),e.backImage&&(0,a.jsx)("img",{src:e.backImage,alt:"Back uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(y,{children:j["card".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["card".concat(s)]})})})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{f([...x,{front:"",back:"",frontImage:null,backImage:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," カードを追加"]}),(0,a.jsxs)(k,{onClick:I,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},e_=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{question:"",answer:"",image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eD(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},w=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),m(e),0===Object.keys(e).length},C=async()=>{if(w())try{let e={title:i,qaItems:n,type:"qa"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},S=e=>{h(x===e?null:e)};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(ee,{ref:u,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>S(s),className:"mobile-friendly-button",children:x===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>j(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,a.jsx)("p",{children:e.answer})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{ref:u,placeholder:"質問",value:e.question,onChange:e=>f(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(eZ,{ref:u,placeholder:"回答",value:e.answer,onChange:e=>f(s,"answer",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(ee,{ref:u,type:"file",accept:"image/*",onChange:e=>g(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(y,{children:o["item".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["item".concat(s)]})})})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{c([...n,{question:"",answer:"",image:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(k,{onClick:C,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eO=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,f]=(0,l.useState)([{question:"",answer:"",image:null}]),[j,g]=(0,l.useState)({}),[w,C]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("qa");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let S=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),f(s.qaItems)}catch(e){console.error("Error loading set:",e)}},Z=(e,s,t)=>{f(x.map((a,l)=>l===e?{...a,[s]:t}:a))},z=e=>{f(x.filter((s,t)=>t!==e))},q=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{Z(e,"image",s.result)},s.readAsDataURL(t)}},E=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.question.trim()&&s.answer.trim()||(e["item".concat(t)]="質問と回答を入力してください。")}),g(e),0===Object.keys(e).length},I=async()=>{if(E())try{let e={id:parseInt(n),title:o,qaItems:x,type:"qa"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"一問一答編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(ep,{onValueChange:S,value:n,children:[(0,a.jsx)(eN,{className:"w-full",children:(0,a.jsx)(eb,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(ew,{children:i.map(e=>(0,a.jsx)(eC,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(ee,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),j.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j.title})})]}),x.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>C(w===s?null:s),className:"mobile-friendly-button",children:w===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>z(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:w===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"質問:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"回答:"}),(0,a.jsx)("p",{children:e.answer})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{placeholder:"質問",value:e.question,onChange:e=>Z(s,"question",e.target.value),className:"mb-2"}),(0,a.jsx)(eZ,{placeholder:"回答",value:e.answer,onChange:e=>Z(s,"answer",e.target.value),className:"mb-2"}),(0,a.jsx)(ee,{type:"file",accept:"image/*",onChange:e=>q(s,e),className:"mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"})]})}),(0,a.jsx)(y,{children:j["item".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["item".concat(s)]})})})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{f([...x,{question:"",answer:"",image:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(k,{onClick:I,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eM=t(9324);let eB=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(eM.fC,{ref:s,className:g("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...l,children:(0,a.jsx)(eM.z$,{className:g("flex items-center justify-center text-current"),children:(0,a.jsx)(eg.Z,{className:"h-4 w-4"})})})});eB.displayName=eM.fC.displayName;var eV=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(null),u=eD(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=e=>{c(n.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},w=(e,s,t,a)=>{c(n.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},C=(e,s)=>{c(n.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},S=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{f(e,"image",s.result)},s.readAsDataURL(t)}},Z=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),m(e),0===Object.keys(e).length},z=async()=>{if(Z())try{let e={title:i,questions:n,type:"multiple-choice"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}},q=e=>{h(x===e?null:e)};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(ee,{placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o.title})})]}),n.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>q(s),className:"mobile-friendly-button",children:x===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>j(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:x===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,a.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{ref:u,placeholder:"問題文",value:e.question,onChange:e=>f(s,"question",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(ee,{ref:u,type:"file",accept:"image/*",onChange:e=>S(s,e),className:"mobile-friendly-input mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(eB,{ref:u,checked:e.isCorrect,onCheckedChange:e=>w(s,t,"isCorrect",e),className:"mr-2"}),(0,a.jsx)(ee,{ref:u,placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>w(s,t,"text",e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>C(s,t),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(k,{onClick:()=>g(s),className:"mobile-friendly-button mt-2",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,a.jsxs)(y,{children:[o["question".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["question".concat(s)]})}),o["question".concat(s,"choices")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["question".concat(s,"choices")]})}),o["question".concat(s,"correct")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["question".concat(s,"correct")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{c([...n,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(k,{onClick:z,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eL=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,f]=(0,l.useState)([]),[j,g]=(0,l.useState)({}),[w,C]=(0,l.useState)(null);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("multiple-choice");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let S=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),f(s.questions)}catch(e){console.error("Error loading set:",e)}},Z=(e,s,t)=>{f(x.map((a,l)=>l===e?{...a,[s]:t}:a))},z=e=>{f(x.filter((s,t)=>t!==e))},q=e=>{f(x.map((s,t)=>t===e?{...s,choices:[...s.choices,{text:"",isCorrect:!1}]}:s))},E=(e,s,t,a)=>{f(x.map((l,i)=>i===e?{...l,choices:l.choices.map((e,l)=>l===s?{...e,[t]:a}:"isCorrect"===t?{...e,isCorrect:!1}:e)}:l))},I=(e,s)=>{f(x.map((t,a)=>a===e?{...t,choices:t.choices.filter((e,t)=>t!==s)}:t))},R=(e,s)=>{let t=s.target.files[0];if(t){let s=new FileReader;s.onloadend=()=>{Z(e,"image",s.result)},s.readAsDataURL(t)}},T=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.question.trim()||(e["question".concat(t)]="問題文を入力してください。"),s.choices.filter(e=>e.text.trim()).length<2&&(e["question".concat(t,"choices")]="少なくとも2つの選択肢を入力してください。"),s.choices.some(e=>e.isCorrect)||(e["question".concat(t,"correct")]="正解を選択してください。")}),g(e),0===Object.keys(e).length},D=async()=>{if(T())try{let e={id:parseInt(n),title:o,questions:x,type:"multiple-choice"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"多肢選択問題編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(ep,{onValueChange:S,value:n,children:[(0,a.jsx)(eN,{className:"w-full",children:(0,a.jsx)(eb,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(ew,{children:i.map(e=>(0,a.jsx)(eC,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(ee,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),j.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j.title})})]}),x.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["問題 ",s+1]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>C(w===s?null:s),className:"mobile-friendly-button",children:w===s?(0,a.jsx)(eI.Z,{className:"h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"h-4 w-4"})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>z(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(v,{children:w===s?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md",children:[(0,a.jsx)("h3",{className:"font-bold mb-2",children:"問題:"}),(0,a.jsx)("p",{children:e.question}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Question",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h3",{className:"font-bold mt-4 mb-2",children:"選択肢:"}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.choices.map((e,s)=>(0,a.jsxs)("li",{className:e.isCorrect?"text-green-600 font-bold":"",children:[e.text," ",e.isCorrect&&"(正解)"]},s))})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eZ,{placeholder:"問題文",value:e.question,onChange:e=>Z(s,"question",e.target.value),className:"mb-2"}),(0,a.jsx)(ee,{type:"file",accept:"image/*",onChange:e=>R(s,e),className:"mb-2"}),e.image&&(0,a.jsx)("img",{src:e.image,alt:"Uploaded",className:"mt-2 max-w-full h-auto"}),(0,a.jsx)("h4",{className:"font-medium mt-4 mb-2",children:"選択肢:"}),e.choices.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(eB,{checked:e.isCorrect,onCheckedChange:e=>E(s,t,"isCorrect",e),className:"mr-2"}),(0,a.jsx)(ee,{placeholder:"選択肢 ".concat(t+1),value:e.text,onChange:e=>E(s,t,"text",e.target.value),className:"flex-grow mr-2"}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>I(s,t),children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(k,{onClick:()=>q(s),className:"mt-2",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 選択肢を追加"]})]})}),(0,a.jsxs)(y,{children:[j["question".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["question".concat(s)]})}),j["question".concat(s,"choices")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["question".concat(s,"choices")]})}),j["question".concat(s,"correct")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["question".concat(s,"correct")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{f([...x,{question:"",choices:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],image:null}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 問題を追加"]}),(0,a.jsxs)(k,{onClick:D,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eP=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)(""),[n,c]=(0,l.useState)([{name:"",items:[""]}]),[o,m]=(0,l.useState)({}),[x,h]=(0,l.useState)(!1),u=eD(),f=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,[s]:t}:a))},j=e=>{c(n.filter((s,t)=>t!==e))},g=e=>{c(n.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},w=(e,s,t)=>{c(n.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},C=(e,s)=>{c(n.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},S=()=>{let e={};return i.trim()||(e.title="セットタイトルを入力してください。"),n.forEach((s,t)=>{s.name.trim()||(e["category".concat(t)]="カテゴリー名を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),m(e),0===Object.keys(e).length},Z=async()=>{if(S())try{let e={title:i,categories:n,type:"classification"},s=await d(e);t({...e,id:s})}catch(e){console.error("Error saving set:",e)}};return(0,a.jsxs)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:[(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題作成"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)(ee,{ref:u,placeholder:"セットのタイトル",value:i,onChange:e=>r(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),o.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o.title})})]}),(0,a.jsxs)(k,{onClick:()=>h(!x),className:"mobile-friendly-button mb-4",children:[x?(0,a.jsx)(eI.Z,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"mr-2 h-4 w-4"}),x?"プレビューを終了":"プレビュー"]}),x?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:i}),n.map((e,s)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold",children:e.name}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]},s))]}):n.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>j(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)(v,{children:[(0,a.jsx)(ee,{ref:u,placeholder:"カテゴリー名",value:e.name,onChange:e=>f(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)(ee,{ref:u,placeholder:"項目 ".concat(t+1),value:e,onChange:e=>w(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>C(s,t),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(k,{onClick:()=>g(s),className:"mobile-friendly-button mt-2",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,a.jsxs)(y,{children:[o["category".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["category".concat(s)]})}),o["category".concat(s,"items")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:o["category".concat(s,"items")]})})]})]},s))]}),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{c([...n,{name:"",items:[""]}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,a.jsxs)(k,{onClick:Z,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})},eQ=e=>{let{onBack:s,onSave:t}=e,[i,r]=(0,l.useState)([]),[n,c]=(0,l.useState)(""),[o,d]=(0,l.useState)(""),[x,f]=(0,l.useState)([{name:"",items:[""]}]),[j,g]=(0,l.useState)({}),[w,C]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=await m("classification");r(e)}catch(e){console.error("Error loading sets:",e)}})()},[]);let S=async e=>{c(e);try{let s=await h(parseInt(e));d(s.title),f(s.categories)}catch(e){console.error("Error loading set:",e)}},Z=(e,s,t)=>{f(x.map((a,l)=>l===e?{...a,[s]:t}:a))},z=e=>{f(x.filter((s,t)=>t!==e))},q=e=>{f(x.map((s,t)=>t===e?{...s,items:[...s.items,""]}:s))},E=(e,s,t)=>{f(x.map((a,l)=>l===e?{...a,items:a.items.map((e,a)=>a===s?t:e)}:a))},I=(e,s)=>{f(x.map((t,a)=>a===e?{...t,items:t.items.filter((e,t)=>t!==s)}:t))},R=()=>{let e={};return o.trim()||(e.title="セットタイトルを入力してください。"),x.forEach((s,t)=>{s.name.trim()||(e["category".concat(t)]="カテゴリー名を入力してください。"),0===s.items.filter(e=>e.trim()).length&&(e["category".concat(t,"items")]="少なくとも1つの項目を入力してください。")}),g(e),0===Object.keys(e).length},T=async()=>{if(R())try{let e={id:parseInt(n),title:o,categories:x,type:"classification"};await u(e),t(e)}catch(e){console.error("Error updating set:",e)}};return(0,a.jsx)("div",{className:"mobile-friendly-form max-w-full overflow-x-hidden",children:(0,a.jsxs)("div",{className:"scrollable-content px-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,className:"mobile-friendly-button",children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"分類問題編集"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)(ep,{onValueChange:S,value:n,children:[(0,a.jsx)(eN,{className:"w-full",children:(0,a.jsx)(eb,{placeholder:"編集するセットを選択"})}),(0,a.jsx)(ew,{children:i.map(e=>(0,a.jsx)(eC,{value:e.id.toString(),children:e.title},e.id))})]}),(0,a.jsx)(ee,{placeholder:"セットのタイトル",value:o,onChange:e=>d(e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),j.title&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j.title})})]}),(0,a.jsxs)(k,{onClick:()=>C(!w),className:"mb-4",children:[w?(0,a.jsx)(eI.Z,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(eR.Z,{className:"mr-2 h-4 w-4"}),w?"プレビューを終了":"プレビュー"]}),w?(0,a.jsxs)("div",{className:"bg-gray-100 p-4 rounded-md mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:o}),x.map((e,s)=>(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h3",{className:"font-bold",children:e.name}),(0,a.jsx)("ul",{className:"list-disc pl-5",children:e.items.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]},s))]}):x.map((e,s)=>(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsxs)(b,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)(N,{className:"text-lg font-medium",children:["カテゴリー ",s+1]}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>z(s),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)(v,{children:[(0,a.jsx)(ee,{placeholder:"カテゴリー名",value:e.name,onChange:e=>Z(s,"name",e.target.value),className:"mobile-friendly-input mb-2 text-base",style:{fontSize:"16px"}}),e.items.map((e,t)=>(0,a.jsxs)("div",{className:"flex mb-2",children:[(0,a.jsx)(ee,{placeholder:"項目 ".concat(t+1),value:e,onChange:e=>E(s,t,e.target.value),className:"mobile-friendly-input flex-grow mr-2 text-base",style:{fontSize:"16px"}}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>I(s,t),className:"mobile-friendly-button",children:(0,a.jsx)(el.Z,{className:"h-4 w-4"})})]},t)),(0,a.jsxs)(k,{onClick:()=>q(s),className:"mobile-friendly-button mt-2",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," 項目を追加"]})]}),(0,a.jsxs)(y,{children:[j["category".concat(s)]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["category".concat(s)]})}),j["category".concat(s,"items")]&&(0,a.jsx)(eq,{variant:"destructive",children:(0,a.jsx)(eE,{children:j["category".concat(s,"items")]})})]})]},s)),(0,a.jsx)("div",{className:"fixed-bottom",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)(k,{onClick:()=>{f([...x,{name:"",items:[""]}])},className:"mobile-friendly-button",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"})," カテゴリーを追加"]}),(0,a.jsxs)(k,{onClick:T,className:"mobile-friendly-button",children:[(0,a.jsx)(eT.Z,{className:"mr-2 h-4 w-4"})," 保存"]})]})})]})})},eU=t(3522),eH=t(1976),eY=t(6753),eG=t(7662),e$=t.n(eG);let eJ=e=>{let{content:s,image:t}=e;return(0,a.jsxs)("div",{className:"text-center w-full",children:[(0,a.jsx)("p",{className:"mb-4 text-lg",children:s}),t&&(0,a.jsx)("div",{className:"mt-4 flex justify-center",children:(0,a.jsx)("img",{src:t,alt:"Flashcard image",className:"max-w-full h-auto max-h-[200px] object-contain rounded-md"})})]})};var eW=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[x,u]=(0,l.useState)([]),[f,j]=(0,l.useState)(0),[g,p]=(0,l.useState)(!1),[b,N]=(0,l.useState)([]),[v,y]=(0,l.useState)(!0),[w,C]=(0,l.useState)(null),S=()=>{let e=x.length;return Math.round(b.filter(Boolean).length/e*100)},Z=e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s};(0,l.useEffect)(()=>{(async()=>{try{y(!0);let e=[];if(e=null===i?(await m("flashcard")).flatMap(e=>e.cards):(await h(parseInt(i))).cards,Array.isArray(e)){d(e);let s=Z(e);u(s),N(Array(s.length).fill(!1))}else throw Error("Invalid data structure")}catch(e){console.error("Error loading flashcards:",e),C("フラッシュカードの読み込み中にエラーが発生しました。")}finally{y(!1)}})()},[i]);let z=()=>{f<x.length-1&&(j(f+1),p(!1))},q=async()=>{let e=S(),t=new Date;await c(i,r,"flashcard",e,t),s(e)};if(v)return(0,a.jsx)("div",{children:"読み込み中..."});if(w)return(0,a.jsx)("div",{children:w});if(0===x.length)return(0,a.jsx)("div",{children:"フラッシュカードがありません。"});let E=x[f];return(0,a.jsxs)("div",{className:"p-2 w-full max-w-[390px] mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"フラッシュカード"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>{let e=Z(o);u(e),j(0),p(!1),N(Array(e.length).fill(!1))},className:"mr-2",children:(0,a.jsx)(eU.Z,{})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:q,children:"終了"})]})]}),(0,a.jsx)("div",{className:e$().flashcardContainer,onClick:()=>{p(!g)},children:(0,a.jsxs)("div",{className:"".concat(e$().flashcard," ").concat(g?e$().flipped:""),children:[(0,a.jsx)("div",{className:e$().front,children:(0,a.jsx)(eJ,{content:E.front,image:E.image})}),(0,a.jsx)("div",{className:e$().back,children:(0,a.jsx)(eJ,{content:E.back})})]})}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,a.jsxs)(k,{onClick:()=>{f>0&&(j(f-1),p(!1))},disabled:0===f,children:[(0,a.jsx)(ed.Z,{className:"mr-2 h-4 w-4"})," 前へ"]}),(0,a.jsxs)("span",{children:[f+1," / ",x.length]}),(0,a.jsxs)(k,{onClick:z,disabled:f===x.length-1,children:["次へ ",(0,a.jsx)(eH.Z,{className:"ml-2 h-4 w-4"})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-center",children:(0,a.jsxs)(k,{onClick:()=>{let e=[...b];e[f]=!0,N(e),z()},className:"mr-2",children:[(0,a.jsx)(eY.Z,{className:"mr-2 h-4 w-4"})," 覚えた"]})})]})},eX=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[x,u]=(0,l.useState)(0),[f,j]=(0,l.useState)(""),[g,w]=(0,l.useState)(!1),[C,S]=(0,l.useState)([]),[Z,z]=(0,l.useState)(!0),[q,E]=(0,l.useState)(null),[I,R]=(0,l.useState)(!1),[T,D]=(0,l.useState)([]);(0,l.useEffect)(()=>{(async()=>{try{z(!0);let e=[];if(e=null===i?(await m("qa")).flatMap(e=>e.qaItems):(await h(parseInt(i))).qaItems,Array.isArray(e))d(e),D(F([...e])),S(Array(e.length).fill(null));else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),E("質問の読み込み中にエラーが発生しました。")}finally{z(!1)}})()},[i]);let F=e=>{for(let s=e.length-1;s>0;s--){let t=Math.floor(Math.random()*(s+1));[e[s],e[t]]=[e[t],e[s]]}return e},A=(0,l.useCallback)(()=>{let e=f.toLowerCase()===T[x].answer.toLowerCase(),s=[...C];s[x]=e,S(s),w(!0),R(x===T.length-1),x<T.length-1&&setTimeout(()=>{u(e=>e+1),j(""),w(!1)},1e3)},[f,T,x,C]),_=async()=>{let e=O(),t=new Date;await c(i,r,"qa",e,t),s(e)},O=()=>{let e=T.length;return Math.round(C.filter(Boolean).length/e*100)};if(Z)return(0,a.jsx)("div",{children:"読み込み中..."});if(q)return(0,a.jsx)("div",{children:q});if(0===T.length)return(0,a.jsx)("div",{children:"質問がありません。"});let M=T[x];return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"一問一答"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>{D(F([...T])),u(0),j(""),w(!1),S(Array(T.length).fill(null))},className:"mr-2",children:(0,a.jsx)(eU.Z,{})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:_,children:"終了"})]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsx)(N,{children:M.question})}),(0,a.jsxs)(v,{children:[M.image&&(0,a.jsx)("img",{src:M.image,alt:"Question",className:"w-full mb-4"}),(0,a.jsx)(ee,{type:"text",placeholder:"回答を入力",value:f,onChange:e=>j(e.target.value),disabled:g})]}),(0,a.jsx)(y,{className:"flex justify-between",children:g?(0,a.jsxs)("div",{className:"flex items-center",children:[C[x]?(0,a.jsx)(eg.Z,{className:"text-green-500 mr-2"}):(0,a.jsx)(U.Z,{className:"text-red-500 mr-2"}),(0,a.jsxs)("span",{children:["正解: ",M.answer]})]}):(0,a.jsx)(k,{onClick:A,children:"回答する"})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{children:[x+1," / ",T.length]})})]})},eK=e=>{let{onFinish:s,onBack:t,setId:i,title:r,quizType:n}=e,[o,d]=(0,l.useState)([]),[m,x]=(0,l.useState)([]),[u,f]=(0,l.useState)(0),[j,g]=(0,l.useState)([]),[w,C]=(0,l.useState)(!1),[S,Z]=(0,l.useState)([]),[z,q]=(0,l.useState)(!0),[E,I]=(0,l.useState)(null),[R,T]=(0,l.useState)(!1),D=()=>{let e=m.length;return Math.round(S.filter(Boolean).length/e*100)},F=e=>{let s=[...e];for(let e=s.length-1;e>0;e--){let t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s},A=e=>({...e,choices:F(e.choices)});(0,l.useEffect)(()=>{(async()=>{try{q(!0);let e=[];if(e=null===i?(await getSets("multiple-choice")).flatMap(e=>e.questions):(await h(parseInt(i))).questions,Array.isArray(e)){d(e);let s=e.map(A),t=F(s);x(t),Z(Array(t.length).fill(null))}else throw Error("Invalid data structure")}catch(e){console.error("Error loading questions:",e),I("質問の読み込み中にエラーが発生しました。")}finally{q(!1)}})()},[i]);let _=e=>{g(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},O=(0,l.useCallback)(()=>{if(j.length>0&&u<m.length){let e=m[u].choices.every((e,s)=>j.includes(s)===e.isCorrect),s=[...S];s[u]=e,Z(s),C(!0),T(u===m.length-1),u<m.length-1&&setTimeout(()=>{f(e=>e+1),g([]),C(!1)},1e3)}},[j,u,m,S]),M=async()=>{let e=D(),t=new Date;await c(i,r,"multiple-choice",e,t),s(e)};if(z)return(0,a.jsx)("div",{children:"読み込み中..."});if(E)return(0,a.jsx)("div",{children:E});if(0===m.length)return(0,a.jsx)("div",{children:"質問がありません。"});let B=m[u];return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:t,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"多肢選択問題"}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:()=>{let e=F(o.map(A));x(e),f(0),g([]),C(!1),Z(Array(e.length).fill(null)),T(!1)},className:"mr-2",children:(0,a.jsx)(eU.Z,{})}),(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:M,children:"終了"})]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsx)(N,{children:B.question})}),(0,a.jsxs)(v,{children:[B.image&&(0,a.jsx)("img",{src:B.image,alt:"Question",className:"w-full mb-4"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:B.choices.map((e,s)=>(0,a.jsx)(k,{variant:j.includes(s)?"default":"outline",className:"justify-start ".concat(w&&e.isCorrect?"bg-green-100":""),onClick:()=>!w&&_(s),disabled:w,children:e.text},s))})]}),(0,a.jsx)(y,{className:"flex justify-between",children:w?(0,a.jsxs)("div",{className:"flex items-center",children:[S[u]?(0,a.jsx)(eg.Z,{className:"text-green-500 mr-2"}):(0,a.jsx)(U.Z,{className:"text-red-500 mr-2"}),(0,a.jsxs)("span",{children:["正解: ",B.choices.filter(e=>e.isCorrect).map(e=>e.text).join(", ")]})]}):(0,a.jsx)(k,{onClick:O,disabled:0===j.length,children:"回答する"})})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsxs)("span",{children:[u+1," / ",m.length]})})]})},e0=t(5149),e2=t(5392),e4=t(5554);let e1=(0,l.memo)(e=>{let{id:s,children:t,isDragging:i,isClassified:r}=e,{attributes:n,listeners:c,setNodeRef:o,transform:d,transition:m}=(0,e2.nB)({id:s}),x=(0,l.useMemo)(()=>({transform:e4.ux.Transform.toString(d),transition:m,opacity:i?.5:1}),[d,m,i]);return(0,a.jsx)("div",{ref:o,style:x,...n,...c,className:"p-2 mb-2 rounded border ".concat(r?"bg-gray-100":"bg-white"," ").concat(i?"shadow-lg":"shadow"),children:t})});e1.displayName="SortableItem";let e6=(0,l.memo)(e=>{let{category:s,children:t,isActive:i,feedbackColor:r,isLeftSide:n}=e,{setNodeRef:c}=(0,e0.Zj)({id:s,data:{category:s}}),o=(0,l.useMemo)(()=>"flex items-center h-32 px-2 rounded transition-colors duration-300 ".concat(r||"bg-gray-100"," ").concat(i?"border-2 border-blue-500":""),[r,i]);return(0,a.jsxs)("div",{ref:c,className:o,children:[n&&i&&(0,a.jsx)("div",{className:"mr-2 overflow-y-auto max-h-full",children:t}),(0,a.jsx)("h3",{className:"text-center",style:{writingMode:"vertical-rl",textOrientation:"upright"},children:s}),!n&&i&&(0,a.jsx)("div",{className:"ml-2 overflow-y-auto max-h-full",children:t})]})});e6.displayName="DroppableCategory";var e3=e=>{var s,t;let{onFinish:i,onBack:r,setId:n,title:c,quizType:o}=e,[d,m]=(0,l.useState)({question:null,userClassification:{},unclassifiedItems:[],correctClassification:{},isFinished:!1,showResults:!1,score:0}),[x,u]=(0,l.useState)(!0),[f,j]=(0,l.useState)(null),[g,y]=(0,l.useState)(null),[w,C]=(0,l.useState)(null);(0,l.useRef)(null);let[S,Z]=(0,l.useState)({}),z=(0,e0.Dy)((0,e0.VT)(e0.we,{activationConstraint:{distance:8}})),q=()=>d.score,E=(0,l.useCallback)(e=>{y(e.active.id)},[]),I=(0,l.useCallback)(e=>{let s=e.over?e.over.id:null;s!==w&&C(s)},[w]),R=(0,l.useCallback)(e=>{let{active:s,over:t}=e;t&&s.id!==t.id&&m(e=>{let a=e.unclassifiedItems.find(e=>e.id===s.id);if(a){var l,i;let r=t.id,n=null!==(i=null===(l=e.correctClassification[r])||void 0===l?void 0:l.includes(a.content))&&void 0!==i&&i,c={...e.userClassification,[r]:[...e.userClassification[r]||[],{...a,category:r}]},o=e.unclassifiedItems.filter(e=>e.id!==s.id),d=Object.values(c).flat().length,m=Object.values(c).flat().filter(s=>{var t,a;return null!==(a=null===(t=e.correctClassification[s.category])||void 0===t?void 0:t.includes(s.content))&&void 0!==a&&a}).length,x=0===o.length;return Z(e=>({...e,[r]:n?"bg-green-200":"bg-red-200"})),{...e,userClassification:c,unclassifiedItems:o,score:d>0?Math.round(m/d*100):0,isFinished:x,showResults:x}}return e}),y(null),C(null)},[]);(0,l.useEffect)(()=>{(async()=>{try{u(!0);let e=await h(parseInt(n));if(e&&Array.isArray(e.categories)){let s={question:"以下の項目を正しく分類してください。",categories:e.categories.map(e=>e.name),items:e.categories.flatMap(e=>e.items.map((s,t)=>({id:"".concat(e.name,"-").concat(t),content:s,category:e.name})))},t=e.categories.reduce((e,s)=>(e[s.name]=s.items,e),{}),a=Object.fromEntries(s.categories.map(e=>[e,[]]));m({question:s,userClassification:a,unclassifiedItems:s.items,correctClassification:t,isFinished:!1,showResults:!1,score:0})}else throw Error("Invalid data structure")}catch(e){console.error("Error loading question:",e),j("質問の読み込み中にエラーが発生しました。")}finally{u(!1)}})()},[n]),(0,l.useEffect)(()=>{if(Object.keys(S).length>0){let e=setTimeout(()=>{Z({})},500);return()=>clearTimeout(e)}},[S]);let T=(0,l.useCallback)(()=>{m(e=>({...e,userClassification:Object.fromEntries(e.question.categories.map(e=>[e,[]])),unclassifiedItems:e.question.items,isFinished:!1,showResults:!1,score:0}))},[]),D=(0,l.useCallback)((e,s)=>(0,a.jsx)(e6,{category:e,isActive:w===e,feedbackColor:S[e],isLeftSide:s,children:(0,a.jsx)(e2.Fo,{items:d.userClassification[e]||[],strategy:e2.qw,children:(0,a.jsx)("div",{className:"flex flex-row-reverse",children:(d.userClassification[e]||[]).map(e=>(0,a.jsx)(e1,{id:e.id,isDragging:e.id===g,isClassified:!0,children:e.content},e.id))})})},e),[d.userClassification,w,g,S]),F=(0,l.useMemo)(()=>{if(!d.question)return{left:[],right:[]};let e=Math.ceil(d.question.categories.length/2);return{left:d.question.categories.slice(0,e),right:d.question.categories.slice(e)}},[d.question]),A=async()=>{let e=q(),s=new Date;await saveStudyHistory(n,setTitle,"classification",e,s),i(e)};return x?(0,a.jsx)("div",{children:"読み込み中..."}):f?(0,a.jsx)("div",{children:f}):d.question?(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto relative",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:r,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h2",{className:"text-xl font-bold",children:"分類クイズ"}),(0,a.jsxs)("div",{className:"text-lg font-bold",children:["スコア: ",d.score,"%"]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsx)(N,{children:d.showResults?"結果":d.question.question})}),(0,a.jsx)(v,{className:"min-h-[300px] relative",children:d.showResults?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4",children:["最終スコア: ",d.score,"%"]}),(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)(k,{onClick:T,children:"もう一度挑戦する"}),(0,a.jsx)(k,{onClick:A,children:"終了する"})]})]}):(0,a.jsxs)(e0.LB,{sensors:z,onDragStart:E,onDragOver:I,onDragEnd:R,children:[(0,a.jsx)("div",{className:"absolute left-0 top-0 bottom-0 flex flex-col justify-start pt-4 gap-2",children:F.left.map(e=>D(e,!0))}),(0,a.jsx)("div",{className:"absolute right-0 top-0 bottom-0 flex flex-col justify-start pt-4 gap-2",children:F.right.map(e=>D(e,!1))}),(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(e2.Fo,{items:d.unclassifiedItems,strategy:e2.qw,children:(0,a.jsx)("div",{className:"w-2/3 max-h-[250px] overflow-y-auto grid grid-cols-2 gap-2",children:d.unclassifiedItems.map(e=>(0,a.jsx)(e1,{id:e.id,isDragging:e.id===g,isClassified:!1,children:e.content},e.id))})})}),(0,a.jsx)(e0.y9,{children:g?(0,a.jsx)("div",{className:"bg-white p-2 rounded border shadow-lg",children:(null===(s=d.unclassifiedItems.find(e=>e.id===g))||void 0===s?void 0:s.content)||(null===(t=Object.values(d.userClassification).flat().find(e=>e.id===g))||void 0===t?void 0:t.content)}):null})]})})]})]}):(0,a.jsx)("div",{children:"質問がありません。"})},e5=e=>{let{onBack:s,overallProgress:t,streak:l,studyHistory:i,dailyGoal:r,todayStudyTime:n}=e;return(0,a.jsxs)("div",{className:"p-4 max-w-md mx-auto",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)(k,{variant:"ghost",size:"icon",onClick:s,children:(0,a.jsx)(ed.Z,{})}),(0,a.jsx)("h1",{className:"text-2xl font-bold ml-2",children:"学習統計"})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsxs)(N,{className:"flex items-center",children:[(0,a.jsx)(B.Z,{className:"mr-2 text-blue-500",size:24}),"全体の進捗"]})}),(0,a.jsxs)(v,{children:[(0,a.jsx)(z,{value:t,className:"w-full"}),(0,a.jsxs)("p",{className:"text-center mt-2 font-bold",children:[t.toFixed(1),"%"]})]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsxs)(N,{className:"flex items-center",children:[(0,a.jsx)(M.Z,{className:"mr-2 text-yellow-500",size:24}),"学習継続日数"]})}),(0,a.jsxs)(v,{children:[(0,a.jsxs)("p",{className:"text-lg font-bold",children:["現在のストリーク: ",l,"日"]}),(0,a.jsxs)("p",{children:["過去最高ストリーク: ",10,"日"]})]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsxs)(N,{className:"flex items-center",children:[(0,a.jsx)(P.Z,{className:"mr-2 text-green-500",size:24}),"今日の学習時間"]})}),(0,a.jsxs)(v,{children:[(0,a.jsx)(z,{value:n/r*100,className:"w-full mb-2"}),(0,a.jsxs)("p",{children:[n,"分 / ",r,"分"]})]})]}),(0,a.jsxs)(p,{className:"mb-4",children:[(0,a.jsx)(b,{children:(0,a.jsxs)(N,{className:"flex items-center",children:[(0,a.jsx)(L.Z,{className:"mr-2 text-purple-500",size:24}),"最近の学習"]})}),(0,a.jsx)(v,{children:(0,a.jsx)("ul",{className:"space-y-2",children:i.slice(0,5).map((e,s)=>(0,a.jsxs)("li",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:e.setTitle}),(0,a.jsxs)("span",{children:[e.score,"%"]})]},s))})})]})]})};function e8(){let{hashPath:e,push:s,isReady:t}=function(){let[e,s]=(0,l.useState)(""),[t,a]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=()=>{let e=window.location.hash.slice(1);console.log("Hash changed to:",e),s(e)};return e(),window.addEventListener("hashchange",e),a(!0),()=>{window.removeEventListener("hashchange",e)}},[]),{hashPath:e,push:e=>{console.log("Pushing path:",e),window.location.hash=e},isReady:t}}(),[i,r]=(0,l.useState)("home"),[n,c]=(0,l.useState)(null),[o,d]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[u,f]=(0,l.useState)(null),[j,g]=(0,l.useState)(null),[p,b]=(0,l.useState)(0),[N,v]=(0,l.useState)(0),[y,w]=(0,l.useState)([]),[C,S]=(0,l.useState)(60),[k,Z]=(0,l.useState)(0);(0,l.useEffect)(()=>{t&&!e&&s("home")},[t,e,s]),(0,l.useEffect)(()=>{console.log("Current hash path:",e);let[s,t]=e.split("/");switch(s){case"":case"home":default:r("home");break;case"createEditSet":r("createEditSet");break;case"quizTypeSelection":r("quizTypeSelection");break;case"flashcard":case"qa":case"multiple-choice":case"classification":c(s),r("edit"===t?"".concat(s,"Edit"):"".concat(s,"Creation"));break;case"quiz":r("quiz");break;case"statistics":r("statistics")}},[e]);let z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";console.log("Navigating to:",e,t),s(t?"".concat(e,"/").concat(t):e)},q=()=>{z("createEditSet")},E=()=>{console.log("handleStartLearning called"),z("quizTypeSelection")},I=()=>{z("statistics")},R=e=>{c(e),z(e,"creation")},T=e=>{c(e),z(e,"edit")},D=async(e,s)=>{x(e),f(s);try{if(null===s)g("すべてのセット");else{let e=await h(s);g(e.title)}z("quiz")}catch(e){console.error("Error fetching set title:",e)}},F=e=>{console.log("Saving data:",e),z("home")},A=e=>{console.log("Quiz finished with results:",e),z("home")};return t?(0,a.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-between p-4",children:(()=>{switch(console.log("Rendering screen:",i),i){case"home":return(0,a.jsx)(er,{onCreateSet:q,onStartLearning:E,onShowStatistics:I,overallProgress:p,setOverallProgress:b,streak:N,setStreak:v,studyHistory:y,setStudyHistory:w,dailyGoal:C,setDailyGoal:S,todayStudyTime:k,setTodayStudyTime:Z});case"createEditSet":return(0,a.jsx)(eh,{onBack:()=>z("home"),onSelectType:R,onEditType:T});case"quizTypeSelection":return(0,a.jsx)(ek,{onBack:()=>z("home"),onStartQuiz:D});case"flashcardCreation":return(0,a.jsx)(eF,{onBack:()=>z("createEditSet"),onSave:F});case"flashcardEdit":return(0,a.jsx)(eA,{onBack:()=>z("createEditSet"),onSave:F});case"qaCreation":return(0,a.jsx)(e_,{onBack:()=>z("createEditSet"),onSave:F});case"qaEdit":return(0,a.jsx)(eO,{onBack:()=>z("createEditSet"),onSave:F});case"multiple-choiceCreation":return(0,a.jsx)(eV,{onBack:()=>z("createEditSet"),onSave:F});case"multiple-choiceEdit":return(0,a.jsx)(eL,{onBack:()=>z("createEditSet"),onSave:F});case"classificationCreation":return(0,a.jsx)(eP,{onBack:()=>z("createEditSet"),onSave:F});case"classificationEdit":return(0,a.jsx)(eQ,{onBack:()=>z("createEditSet"),onSave:F});case"quiz":switch(m){case"flashcard":return(0,a.jsx)(eW,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"qa":return(0,a.jsx)(eX,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"multiple-choice":return(0,a.jsx)(eK,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});case"classification":return(0,a.jsx)(e3,{setId:u,title:j,quizType:m,onBack:()=>z("quizTypeSelection"),onFinish:A});default:return null}case"statistics":return(0,a.jsx)(e5,{onBack:()=>z("home"),overallProgress:p,streak:N,studyHistory:y,dailyGoal:C,todayStudyTime:k});default:return(0,a.jsxs)("div",{children:["Unknown screen: ",i]})}})()}):null}function e9(){return(0,a.jsx)(e8,{})}},7662:function(e){e.exports={flashcardContainer:"FlashcardQuiz_flashcardContainer__aqgvO",flashcard:"FlashcardQuiz_flashcard__08I4i",flipped:"FlashcardQuiz_flipped__cz657",front:"FlashcardQuiz_front__NwySn",back:"FlashcardQuiz_back__OO3St"}}},function(e){e.O(0,[947,168,971,23,744],function(){return e(e.s=8352)}),_N_E=e.O()}]);